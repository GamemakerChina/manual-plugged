<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" src="../../../assets/import/jquery-3.6.1.min.js"></script><script type="text/javascript" src="../../../assets/import/layer/layer.js"></script><script type="text/javascript" src="../../../assets/import/pangu.min.js"></script><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/layui_btn.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/layui_col.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/theme/default/layer.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/main.css"><script>let str;removeHtml=function(n){return n=(n=(n=(n=n.replace(/(<([^>]+)>)/gi,"{}")).replace(/\r\n/g,"\n")).replace(/\n/g,"")).replace(/ {2,}/g," ")},retHtml=function(n){return n.match(/(<([^>]+)>)/gi)},setTranslator=function(n,t,o){let e;e=o?n.attr(o):n.html();let a=t[removeHtml(e)];if(null!=a&&a.length){t=retHtml(e);let s=0;t&&t.forEach(function(n,t){var o=a.replace("{"+s+"}",n);a=o===a?a.replace("{}",n):o,s++}),o?n.attr(o,a):n.html(a)}},noTranslationState=function(){return"true"==window.localStorage.getItem("noTranslationState")},noTranslationStateToggle=function(){window.localStorage.setItem("noTranslationState",!noTranslationState())},addNoTranslationStateButton=function(){var n=`
		
		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		window.location.replace('gmmt://'+document.location.hash)
		"
		>打开编辑器</button>

		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		noTranslationStateToggle();
		location.reload();
    	event.stopPropagation();
		"
		>切换翻译</button>
		`;$(".header").length?$(".header").append(n):($(".topic-header").append(n),$(".topic-header button").css("position","relative").css("top","44px"))},removeExtensionFromHash=function(n){return n.replaceAll("#t=","").replaceAll("%2F","/").replaceAll(".htm","")};let json_global,json_file={Example:"范例",'Finally, if you start playing additional sounds with a higher priority while this sound is playing, these will also take up a channel (or a {}voice{}). If no free channels are left then {}ins_snd_bgm{}&nbsp;may be forced to stop and the&nbsp;{}Audio Playback Ended{}&nbsp;event is triggered. In this case, {}"was_stopped"{} is also set to {}true{}.':'最后，如果您在播放此声音时开始播放优先级更高的其他声音，这些声音也会占用一个频道(或{}声音{})。如果没有剩余的空闲频道，则可能会强制停止 {}ins_snd_bgm{}，并触发{}音频播放结束{}事件。在本例中，{}"was_stopped"{} 也设置为 {}true{}。',"If you call no&nbsp;other sound functions&nbsp;on this sound, it will&nbsp;play until the end. At that point, the&nbsp;{}Audio Playback Ended{}&nbsp;event is triggered for the sound. The&nbsp;{}{}async_load{}{}&nbsp;ds_map will contain the following values in that case:&nbsp;":"如果您没有其他声音函数在这个声音上，它会播放到最后。此时{}音频播放已结束{}为声音触发事件。{}{}async_load{}{} 在这种情况下，ds_map 将包含以下值：","If you stop the sound before it reaches its end, the {}Audio Playback Ended{}&nbsp;event is triggered as well. This can be done using any of the following lines of code:&nbsp;":"如果您在声音结束前将其停止，则也会触发{}音频播放结束{}事件。这可以使用以下任何代码行来完成：",'In this case, the sound was stopped through a call to one of the {}audio_stop_{} functions, so instead&nbsp;of being {}false{},&nbsp;{}"was_stopped"{} will be {}true{}&nbsp;here.':'在本例中，声音是通过调用一个 {}audio_stop_{} 函数来停止的，因此不是 {}false{}，而是 {}"was_stopped"{} 在这里将是 {}true{}。',"Playback&nbsp;of a&nbsp;sound ends in the following situations:&nbsp;":"播放声音在以下情况下结束：","Suppose you play a sound using any of the {}audio_play_sound_{} functions:&nbsp;":"假设您使用以下任何 {}audio_play_sound_{} 函数播放声音：","The event returns information in&nbsp;the&nbsp;{}{}async_load{}{}&nbsp;ds_map. The map contains the following keys in case of an&nbsp;{}Audio Playback Ended{}&nbsp;event:&nbsp;":"该事件在 {}{}async_load{}{} ds_map 中返回信息。如果发生{}音频播放已结束{}事件：","The event will trigger in all objects that have it, for any sound played in the game (even when it's not played by the same object).":"对于游戏中播放的任何声音(即使它不是由同一对象播放的)，该事件将在所有具有该事件的对象中触发。","The sound is {}forced to stop{} due to {}voice stealing{}: when another sound is played using any&nbsp;of the {}audio_play_sound_{} functions&nbsp;and all channels are used (see&nbsp;{}{}audio_channel_num{}{}), a channel playing a sound with a lower priority than the new&nbsp;one will be used to play the new sound, i.e. the channel is {}stolen{}&nbsp;by the new sound. An&nbsp;{}Audio Playback Ended{}&nbsp;event is triggered for the sound that was forced to stop playing.":"声音因{}语音抢断{}而{}被迫停止{}：当使用 {}audio_play_sound_{} 函数中的任何播放另一个声音并且使用了所有频道(请参阅 {}{}audio_channel_num{}{}) 时，播放优先级低于新声音的频道将被用于播放新声音，即该频道被新声音{}抢断{}。对于被强制停止播放的声音，会触发{}音频播放结束{}事件。","The sound is {}stopped{}, through a call to&nbsp;{}{}audio_stop_sound{}{}&nbsp;or&nbsp;{}{}audio_stop_all{}{}. I.e. stopping a sound also {}always{} means it ends playback.":"通过调用{}{}audio_stop_sound{}{}或{}{}audio_stop_all{}{}，声音被{0}停止{1}。也就是说，停止声音{}也意味着{}它结束播放。","The sound {}reaches its end position{}. Pausing a sound using {}{}audio_pause_sound{}{}, changing its track position using&nbsp;{}{}audio_sound_set_track_position{}{}&nbsp;or looping a section of it by changing the&nbsp;{}Audio Loop Points{}&nbsp;postpones the end of playback as the sound doesn't reach the end position this way.":"声音 {} 到达其结束位置 {}。使用 {}{}audio_pause_sound{}{} 暂停声音，更改其曲目位置使用 {}{}audio_sound_set_track_position{}{} 或通过更改 {} 音频循环点 {} 来循环其中的一段声音会推迟播放的结束，因为声音不会以这种方式到达结束位置。",'{}"asset_id"{} - the index of the&nbsp;{}{}Sound Asset{}{}.':'{}"asset_id"{} - {}{}声音资源{}{}的索引。','{}"sound_id"{} - the sound ID returned by&nbsp;{}{}audio_play_sound{}{} and stored in&nbsp;{}ins_snd_bgm{}':'{}"sound_id"{} - {}{}audio_play_sound{}{} 返回并存储在 {}ins_snd_bgm{} 中的声音 ID','{}"sound_id"{} - the&nbsp;{}{}Sound Instance ID{}{} that ended playback.':'{}"sound_id"{} - 结束播放的{}{}声音实例 ID{}{}。','{}"was_stopped"{} - this is set to {}false{}, unless the sound was stopped manually using the {}audio_stop_{} functions or when it was forced to stop playing.':'{}"was_stopped"{} - 它被设置为 {}false{}，除非声音是使用 {}audio_stop_{} 函数手动停止的，或者当它被强制停止播放时。','{}"was_stopped"{} -&nbsp;{}false{}&nbsp;(the sound wasn\'t stopped {}or{} forced to stop)':'{}"was_stopped"{} -&nbsp;{}false{}&nbsp;(声音没有停止{}或{}没有被强制停止)',"{}Audio Playback Ended{}":"{}音频播放结束{}","{}This event is triggered whenever playback ends for a sound instance played using the {}audio_play_sound_{} functions.":"{}每当使用 {}audio_play_sound_{} 函数播放的声音实例播放结束时，都会触发此事件。","{}{}NOTE{}{}&nbsp;{}Pausing{} a sound does {}not{} end playback, as playback can still be {}resumed{}&nbsp;afterwards.":"{}{}注意{}{} {}暂停{}声音{}不会{}结束播放，因为之后仍可以{}继续{}播放。"},get_json_global=$.ajax({url:"/global.json",type:"GET",dataType:"json",async:!1,success:function(n){json_global=n}});$(function(){if(addNoTranslationStateButton(),noTranslationState())return!1;$("div.footer a,h4,caption").each(function(){setTranslator($(this),json_global)}),$("p,h1,h2,h3,td,li,a,div.dropspotnote,figcaption").each(function(){setTranslator($(this),json_file)}),$("th,.warning,.important,.optional").each(function(){setTranslator($(this),json_global)}),$(".header").length&&(window.setInterval(function(){$("#toc-panel a:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)}),$(".GlossDefinitionText:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)})},250),console.log("成功啦!现在正在疯狂翻译菜单中!")),$(".tooltip").each(function(){setTranslator($(this),json_global,"title")})}),document.addEventListener("DOMContentLoaded",()=>{pangu.autoSpacingPage()})</script><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../../..",gTopicId="6.3.1.2.0_2"</script><script type="text/javascript" src="../../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><link rel="stylesheet" type="text/css" href="../../../assets/css/default.css"><script src="../../../../assets/scripts/main_script.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="Adobe RoboHelp 2022"><title>Audio Playback Ended</title><meta name="topic-status" content="Draft"><link rel="stylesheet" type="text/css" href="../../../assets/css/default.css"><meta name="rh-authors" content="Bart Teunis"><meta name="topic-comment" content="Reference page for the async Audio Playback Ended event"><meta name="template" content="../../../assets/masterpages/Manual_Page.htt"><meta name="search-keywords" content="Audio Playback Ended,ev_async_audio_playback_ended"><meta name="rh-index-keywords" content="Objects - Async Audio Playback Ended Event"><meta name="brsnext" value="The_Asset_Editors/Object_Properties/Async_Events/Audio_Recording.htm"><meta name="brsprev" value="The_Asset_Editors/Object_Properties/Async_Events/Audio_Playback.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="Audio Playback Ended"><span>Audio Playback Ended</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><div></div><div><h1><span data-field="title" data-format="default">Audio Playback Ended</span></h1><p><img class="center" src="../../../assets/Images/Asset_Editors/Async_AudioPlaybackEnded.png" style="cursor:nesw-resize">This event is triggered whenever playback ends for a sound instance played using the <span class="inline2">audio_play_sound_</span> functions.</p><p>Playback&nbsp;of a&nbsp;sound ends in the following situations:&nbsp;</p><ul class="colour"><li>The sound <strong>reaches its end position</strong>. Pausing a sound using <span class="inline3_func"><a href="../../../GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_pause_sound.htm">audio_pause_sound</a></span>, changing its track position using&nbsp;<span class="inline3_func"><a href="../../../GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_sound_set_track_position.htm">audio_sound_set_track_position</a></span>&nbsp;or looping a section of it by changing the&nbsp;<a href="../../../GameMaker_Language/GML_Reference/Asset_Management/Audio/Audio_Loop_Points/Audio_Loop_Points.htm">Audio Loop Points</a>&nbsp;postpones the end of playback as the sound doesn't reach the end position this way.</li><li>The sound is <strong>stopped</strong>, through a call to&nbsp;<span class="inline3_func"><a href="../../../GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_stop_sound.htm">audio_stop_sound</a></span>&nbsp;or&nbsp;<span class="inline3_func"><a href="../../../GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_stop_all.htm">audio_stop_all</a></span>. I.e. stopping a sound also <em>always</em> means it ends playback.</li><li>The sound is <strong>forced to stop</strong> due to <em>voice stealing</em>: when another sound is played using any&nbsp;of the <span class="inline2">audio_play_sound_</span> functions&nbsp;and all channels are used (see&nbsp;<span class="inline3_func"><a href="../../../GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_channel_num.htm">audio_channel_num</a></span>), a channel playing a sound with a lower priority than the new&nbsp;one will be used to play the new sound, i.e. the channel is <em>stolen</em>&nbsp;by the new sound. An&nbsp;<span data-field="title" data-format="default">Audio Playback Ended</span>&nbsp;event is triggered for the sound that was forced to stop playing.</li></ul><p>The event will trigger in all objects that have it, for any sound played in the game (even when it's not played by the same object).</p><p>The event returns information in&nbsp;the&nbsp;<span class="inline2"><a href="../../../GameMaker_Language/GML_Overview/Variables/Builtin_Global_Variables/async_load.htm">async_load</a></span>&nbsp;ds_map. The map contains the following keys in case of an&nbsp;<span data-field="title" data-format="default">Audio Playback Ended</span>&nbsp;event:&nbsp;</p><ul class="colour"><li><strong>"sound_id"</strong> - the&nbsp;<span data-keyref="Type_ID_Sound_Instance"><a target="_blank" href="../../../GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_play_sound.htm">Sound Instance ID</a></span> that ended playback.</li><li><strong>"asset_id"</strong> - the index of the&nbsp;<span data-keyref="Type_Asset_Sound"><a target="_blank" href="../../Sounds.htm">Sound Asset</a></span>.</li><li><strong>"was_stopped"</strong> - this is set to <span class="inline2">false</span>, unless the sound was stopped manually using the <span class="inline2">audio_stop_</span> functions or when it was forced to stop playing.</li></ul><p class="note"><span data-conref="../../../assets/snippets/Tag_note.hts"><span class="note">NOTE</span></span>&nbsp;<em>Pausing</em> a sound does <em>not</em> end playback, as playback can still be <em>resumed</em>&nbsp;afterwards.</p><h2>Example</h2><p>Suppose you play a sound using any of the <span class="inline2">audio_play_sound_</span> functions:&nbsp;</p><p class="code">ins_snd_bgm = audio_play_sound(snd_music, 100, false);</p><p>If you call no&nbsp;other sound functions&nbsp;on this sound, it will&nbsp;play until the end. At that point, the&nbsp;<span data-field="title" data-format="default">Audio Playback Ended</span>&nbsp;event is triggered for the sound. The&nbsp;<span class="inline2"><a href="../../../GameMaker_Language/GML_Overview/Variables/Builtin_Global_Variables/async_load.htm">async_load</a></span>&nbsp;ds_map will contain the following values in that case:&nbsp;</p><ul class="colour"><li><strong>"sound_id"</strong> - the sound ID returned by&nbsp;<span class="inline3_func"><a href="../../../GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_play_sound.htm">audio_play_sound</a></span> and stored in&nbsp;<span class="inline2">ins_snd_bgm</span></li><li><strong>"asset_id"</strong> -&nbsp;<span class="inline2">snd_music</span></li><li><strong>"was_stopped"</strong> -&nbsp;<span class="inline2">false</span>&nbsp;(the sound wasn't stopped <em>or</em> forced to stop)</li></ul><p>If you stop the sound before it reaches its end, the <span data-field="title" data-format="default">Audio Playback Ended</span>&nbsp;event is triggered as well. This can be done using any of the following lines of code:&nbsp;</p><p class="code">// Stop the sound instance<br>audio_stop_sound(ins_snd_bgm);<br><br>// Stop all instances of the sound asset<br>audio_stop_sound(snd_relaxed);<br><br>// Stop all sounds that are playing<br>audio_stop_all();</p><p>In this case, the sound was stopped through a call to one of the <span class="inline2">audio_stop_</span> functions, so instead&nbsp;of being <span class="inline2">false</span>,&nbsp;<span class="inline2">"was_stopped"</span> will be <span class="inline2">true</span>&nbsp;here.</p><p>Finally, if you start playing additional sounds with a higher priority while this sound is playing, these will also take up a channel (or a <em>voice</em>). If no free channels are left then <span class="inline2">ins_snd_bgm</span>&nbsp;may be forced to stop and the&nbsp;<span data-field="title" data-format="default">Audio Playback Ended</span>&nbsp;event is triggered. In this case, <span class="inline2">"was_stopped"</span> is also set to <span class="inline2">true</span>.</p><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div>Back:&nbsp;<a href="../Async_Events.htm">Async Events</a></div><div>Next:&nbsp;<a href="Audio_Recording.htm">Audio Recording</a></div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div></div></body></html>
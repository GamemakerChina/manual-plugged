<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" src="../../assets/import/jquery-3.6.1.min.js"></script><script type="text/javascript" src="../../assets/import/layer/layer.js"></script><script type="text/javascript" src="../../assets/import/pangu.min.js"></script><link rel="stylesheet" type="text/css" href="../../assets/import/layer/layui_btn.css"><link rel="stylesheet" type="text/css" href="../../assets/import/layer/layui_col.css"><link rel="stylesheet" type="text/css" href="../../assets/import/layer/theme/default/layer.css"><link rel="stylesheet" type="text/css" href="../../assets/import/main.css"><script>let str;removeHtml=function(t){return t=(t=(t=(t=t.replace(/(<([^>]+)>)/gi,"{}")).replace(/\r\n/g,"\n")).replace(/\n/g,"")).replace(/ {2,}/g," ")},retHtml=function(t){return t.match(/(<([^>]+)>)/gi)},setTranslator=function(t,n,a){let e;e=a?t.attr(a):t.html();let l=n[removeHtml(e)];if(null!=l&&l.length){n=retHtml(e);let o=0;n&&n.forEach(function(t,n){var a=l.replace("{"+o+"}",t);l=a===l?l.replace("{}",t):a,o++}),a?t.attr(a,l):t.html(l)}},noTranslationState=function(){return"true"==window.localStorage.getItem("noTranslationState")},noTranslationStateToggle=function(){window.localStorage.setItem("noTranslationState",!noTranslationState())},addNoTranslationStateButton=function(){$(".header").length&&$(".header").append(`
		
		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		window.location.replace('gmmt://'+document.location.hash)
		"
		>打开编辑器</button>

		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		noTranslationStateToggle();
		location.reload();
    	event.stopPropagation();
		"
		>切换翻译</button>
		`)},removeExtensionFromHash=function(t){return t.replaceAll("#t=","").replaceAll("%2F","/").replaceAll(".htm","")},$(function(){if(addNoTranslationStateButton(),noTranslationState())return!1;$("div.footer a,h4,caption,blockquote").each(function(){setTranslator($(this),json_global)}),$("p,h1,h2,h3,td,li,a,div.dropspotnote,figcaption,.expandtext").each(function(){setTranslator($(this),json)}),$("th,.warning,.important,.optional").each(function(){setTranslator($(this),json_global)}),$(".header").length&&(window.setInterval(function(){$("#toc-panel a:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)}),$(".GlossDefinitionText:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)})},250),console.log("成功啦!现在正在疯狂翻译菜单中!")),$(".tooltip").each(function(){setTranslator($(this),json_global,"title")})}),document.addEventListener("DOMContentLoaded",()=>{pangu.autoSpacingPage()})</script><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../..",gTopicId="6.7.0_8"</script><script type="text/javascript" src="../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Broadcast Messages</title><meta name="generator" content="Adobe RoboHelp 2022"><link rel="stylesheet" href="../../assets/css/default.css" type="text/css"><script src="../../assets/scripts/main_script.js" type="module"></script><meta name="rh-authors" content="Mark Alexander"><meta name="topic-comment" content="Page detailing the dope sheet"><meta name="rh-index-keywords" content="Sequences - Broadcast Messages"><meta name="search-keywords" content="broadcast,messages,broadcast messages"><meta name="brsnext" value="The_Asset_Editors/Shaders.htm"><meta name="brsprev" value="The_Asset_Editors/Sequence_Properties/Using_Animation_Curves.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="Broadcast Messages"><span>Broadcast Messages</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><h1>Broadcast Messages</h1><p>Both <a href="../Sequences.htm">Sequences</a> and <a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sprites/Sprites.htm">Sprites</a>&nbsp;can generate what are called <strong>broadcast messages</strong> at any point along their length. These messages are simple strings that are added to specific frames along the animation timeline, and when that point in the timeline is reached, then the string will be broadcast out to all instances that listen for it. Any instance that has a <a href="../Object_Properties/Other_Events.htm">Broadcast Message Event</a> (found in the "<strong>Other</strong>" event category) will receive the message string when it is reached in the timeline, at which point it's up to you to have some code that will parse it and react accordingly. Note too that sequences can also listen for broadcast messages, but this requires you to first set up the listener method using code (see the GML section on <a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sequences/Sequence_Events_Moments_Broadcast.htm">Sequence Events And Moments</a>&nbsp;for more information).</p><p class="note"><strong><span class="note">NOTE</span></strong>&nbsp;Setting the <strong>image_index</strong> of an instance directly to a frame will&nbsp;<em>not</em> trigger any Broadcast Messages that may be present on that frame of the object's sprite.</p><p>To add a Broadcast Message&nbsp;to the sequence or sprite timeline you simply click the&nbsp;<img alt="Broadcast Message Button Icon" class="icon" src="../../assets/Images/Icons/Icon_Broadcast.png">&nbsp;button. This&nbsp;will open a dialog where you can add the message to be broadcast:</p><p class="dropspot"><img alt="Add A broadcast message to a sequence" class="center" src="../../assets/Images/Asset_Editors/Editor_Sequences_Broadcast.gif" style="cursor:nesw-resize"></p><p>Once added, the message will be shown in the Dope Sheet (or in the sprite frame view). To edit it, you must&nbsp;click the right mouse button <img alt="RMB Icon" class="icon" height="24" src="../../assets/Images/Icons/Icon_RMB.png" width="21">&nbsp;on the message icon&nbsp;to open a list of all the messages that overlap the frame (there can only be one message on a frame, but placing multiple messages on consecutive frames will cause them to overlap visually, making it harder to select the one you want and you can have a message and a&nbsp;<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sequences/Sequence_Events_Moments_Broadcast.htm">moment</a>&nbsp;on the same frame too), and then selecting one from this list will open the message dialog where you can edit it or remove it.</p><p>When a Broadcast Message event is triggered, there will be a special <a href="../../GameMaker_Language/GML_Reference/Data_Structures/DS_Maps/DS_Maps.htm">DS Map</a>&nbsp;created and stored in the built-in variable <span class="inline">event_data</span>. This variable ID is a built-in <em>global</em> scope variable, but will only contain DS map data in the event that triggered it -&nbsp;in this case the Broadcast Message event - and will return -1 at all other times. The keys that the event will have are as follows:</p><table><colgroup><col><col><col></colgroup><tbody><tr><th colspan="3"><span data-keyref="Type_Struct_Message_Event"><a target="_blank" href="Broadcast_Messages.htm">Message Event Struct</a></span></th></tr><tr><th>Variable</th><th>Type</th><th>Description</th></tr><tr><td><span class="inline">event_type</span></td><td><span data-keyref="Type_String"><a target="_blank" href="../../GameMaker_Language/GML_Overview/Data_Types.htm">String</a></span></td><td>This will be the string "<span class="inline">sequence event</span>" for a message sent from a Sequence and "<span class="inline">sprite event</span>" for a message sent from a Sprite.</td></tr><tr><td><span class="inline">message</span></td><td><span data-keyref="Type_String"><a target="_blank" href="../../GameMaker_Language/GML_Overview/Data_Types.htm">String</a></span></td><td>This contains the message string that has been received.</td></tr><tr><td><span class="inline">element_id</span></td><td><span data-keyref="Type_ID_Layer_Element"><a target="_blank" href="../../GameMaker_Language/GML_Reference/Asset_Management/Rooms/General_Layer_Functions/layer_get_all_elements.htm">Layer Element ID</a></span></td><td>This contains the ID of the layer element (sequence/sprite/instance) that fired the message. You can then use this ID value to find out what kind of element generated the message using the function <a href="../../GameMaker_Language/GML_Reference/Asset_Management/Rooms/General_Layer_Functions/layer_get_element_type.htm"><span class="inline">layer_get_element_type()</span></a>&nbsp;and to use the other relevant functions to target it, or perform an action like play a sound, as required.</td></tr></tbody></table><p>Note that the broadcast message event of an instance will receive multiple strings for each of the times a broadcast message is sent. You do not need to act on all of them, and can have different instances listening for different broadcast strings. However, you may have an instance that is listening for messages that may be received at the same time.&nbsp;When this happens, the event will be triggered multiple times - <em>once for each message string</em>.</p><p>Below is a brief example of how this event can be checked:</p><p class="code">if event_data[? "event_type"] == "sequence event" // or you can check "sprite event"<br>{<br>&nbsp; &nbsp; switch (event_data[? "message"])<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; case "hit":<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; audio_play_sound(snd_hit, 0, false);<br>&nbsp; &nbsp; &nbsp; &nbsp; break;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; case "destroy":<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sequence_destroy(event_data[? "element_id"]);<br>&nbsp; &nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; }<br>}</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div style="float:left">Back: <a href="../Sequences.htm">Sequences</a></div><div style="float:right">Next: <a href="The_Sequence_Canvas.htm">The Sequence Canvas</a></div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div></body></html>
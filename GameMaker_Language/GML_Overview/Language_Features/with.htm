<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" src="../../../assets/import/jquery-3.6.1.min.js"></script><script type="text/javascript" src="../../../assets/import/layer/layer.js"></script><script type="text/javascript" src="../../../assets/import/pangu.min.js"></script><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/layui_btn.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/layui_col.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/theme/default/layer.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/main.css"><script>let str;removeHtml=function(e){return e=(e=(e=(e=e.replace(/(<([^>]+)>)/gi,"{}")).replace(/\r\n/g,"\n")).replace(/\n/g,"")).replace(/ {2,}/g," ")},retHtml=function(e){return e.match(/(<([^>]+)>)/gi)},setTranslator=function(e,t,n){let o;o=n?e.attr(n):e.html();let s=t[removeHtml(o)];if(null!=s&&s.length){t=retHtml(o);let a=0;t&&t.forEach(function(e,t){var n=s.replace("{"+a+"}",e);s=n===s?s.replace("{}",e):n,a++}),n?e.attr(n,s):e.html(s)}},noTranslationState=function(){return"true"==window.localStorage.getItem("noTranslationState")},noTranslationStateToggle=function(){window.localStorage.setItem("noTranslationState",!noTranslationState())},addNoTranslationStateButton=function(){var e=`
		
		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		window.location.replace('gmmt://'+document.location.hash)
		"
		>打开编辑器</button>

		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		noTranslationStateToggle();
		location.reload();
    	event.stopPropagation();
		"
		>切换翻译</button>
		`;$(".header").length?$(".header").append(e):($(".topic-header").append(e),$(".topic-header button").css("position","relative").css("top","44px"))},removeExtensionFromHash=function(e){return e.replaceAll("#t=","").replaceAll("%2F","/").replaceAll(".htm","")};let json_global,json_file={"An example of using {}continue{} in a {}with{}&nbsp;loop would be:":"在 {}with{} 循环中使用 {}continue{} 的示例如下：","As indicated in the section {}Addressing Variables in Other Instances{}, it is possible to read and change the value of variables in instances and {}structs{} other than the one currently executing any given code. However, in a number of cases you want to do a lot more than just change a single variable within those other instances, and may want to perform more complex code actions that require multiple functions and lines of code. For example, imagine that you want to move all the instances of a ball object in your game 8 pixels down. You may think that this is achieved simply by the following piece of code:":"正如{}在其他实例中处理变量{}一节所指出的，可以读取和改变当前执行任何给定代码的实例和{}结构{}中的变量值。然而，在很多情况下，你想做的事情远不止是在这些其他实例中改变一个变量，而且可能想执行更复杂的代码操作，需要多个函数和代码行。例如，想象一下，你想把你游戏中的一个球对象的所有实例向下移动8像素。你可能认为这只需通过下面这段代码即可实现。","As mentioned above, within the statement(s), the indicated instance or struct&nbsp;has become the target ({}self{}) instance that runs the code block, which means that the original instance (that contains the {}with{} and the entire code block) has become the {}{}other{}{} instance. So - for example -&nbsp;to move all balls to the position of the current instance that actually contains the code, you can type this:":"如上所述，在语句中，指示的实例或结构已成为运行代码块的目标 ({}self{}) 实例，这意味着原始实例（包含 {}with{} 和整个代码块）已成为 {}{}other{}{} 实例。因此 - 例如 - 要将所有球移动到实际包含代码的当前实例的位置，您可以键入：","As mentioned above, within the statement(s), the indicated instance or struct&nbsp;has become the target ({}self{}) instance that runs the code block, which means that the original instance (that contains the&nbsp;{}{}with{}{} and the entire code block) has become the {}{}other{}{} instance.":"如上所述，在语句内，指示的实例或结构已成为运行代码块的目标({}self{}) 实例，这意味着原始实例(包含{}{}with{}{}和整个代码块)已成为{}{}其他{}{}实例。","Because&nbsp;{}{}with{}{}&nbsp;behaves as a loop, you can use the special {}{}break{}{} and {}{}continue{}{} statements in it as well. Using {}break{} will immediately exit the&nbsp;{}{}with{}{} code block and move on to any code that is in the event or function after the {}with{} should have finished, e.g.:":"由于{}{}with{}{}表现为循环，因此您也可以在其中使用特殊的{}{}break{}{}和{}{}continue{}{}语句。使用{}break{}将立即退出{}{}with{}{}代码块，并在{}with{}完成后继续执行事件或函数中的任何代码，例如：","But this is not correct, as the right side of the assignment gets the value of the y-coordinate of the first ball and adds 8 to it. Next this new value is set as the y-coordinate of {}all {}balls, so the result is that all balls get the same y-coordinate, and even if you use the following:":"但这是不正确的，因为赋值的右侧获取第一个球的 y 坐标值并将其加 8。接下来，这个新值被设置为{}所有{}球的 y 坐标，因此结果是所有球都获得相同的 y 坐标，即使您使用以下内容也是如此：","But this is not correct, as the right-hand side of the assignment gets the value of the y-coordinate of the first ball and adds 8 to it. Next this new value is set as the y-coordinate of {}all {}balls, so the result is that all balls get the same y-coordinate, and even if you use the following:":"但这是不正确的，因为赋值的右侧获取第一个球的 y 坐标值并加 8。接下来，这个新值被设置为所有球的 y 坐标，因此结果是所有球都获得相同的 y 坐标，即使您使用以下命令：","Essentially this is a loop, and each {}iteration{}&nbsp;of the loop, the code will run on one instance of the object {}obj_ball{}.":"从本质上讲，这是一个循环，循环的每次{}迭代{}，代码都会在对象 {}obj_ball{} 的一个实例上运行。","Executing Code in a New Instance":"在新实例中执行代码","For the {}expression{}, you can indicate&nbsp;one or more instances (or a struct)&nbsp;to perform the code on, using&nbsp;an instance ID, the object ID (which indicates that&nbsp;{}all instances{}&nbsp;in the room of this object are to run the code block), the struct ID,&nbsp;or one of the special&nbsp;{}keywords{}&nbsp;({}all{}&nbsp;or&nbsp;{}other{}). This will then change the {}scope{} of the code within the curly brackets {}{}{}&nbsp;from&nbsp;the instance, struct or function that actually holds the code to the instance (or instances or struct) given in the expression.":"对于{}表达式{}，您可以使用实例 ID 指示一个或多个实例（或结构）执行代码，对象 ID（指示此对象房间中的{}所有实例{}用于运行代码块）、结构 ID 或特殊{}关键字{}之一（{}all{} 或 {}other{}）。然后，这会将大括号 {}{}{} 内代码的{}范围{}从实际保存代码的实例、结构或函数更改为表达式中给出的实例（或多个实例或结构）。","If you want to execute multiple statements, just include them in the curly brackets, the same as you would around any other code block. So for example, to move all the balls in our example to a random position and give them a random speed and direction, you would use:":"如果你想执行多条语句，只需将它们包含在大括号中，就像你在任何其他代码块周围一样。因此，例如，要将示例中的所有球移动到随机位置并给它们随机速度和方向，您可以使用：","Instance Checking Functions":"实例检查函数","It is worth noting that you can use the special {}{}break{}{} and {}{}continue{}{} statements within a {}{}{}with{}{}{}&nbsp;call too. Using {}break{} will immediately exit the {}with{} code block and move on to any code that is in the event or function after the {}with{} should have finished, eg:":"值得注意的是，您也可以在 {}{}{}with{}{}{} 调用中使用特殊的 {}{}break{}{} 和 {4}{5}continue{6}{7} 语句。使用 {}break{} 将立即退出 {}with{} 代码块，并在 {}with{} 应该完成后继续执行事件或函数中的任何代码，例如：","Local Variable to Cross Scopes":"跨作用域的局部变量","Once the expression has set the scope of the {}with{}, the {}statement{} will then be executed for each of the indicated instances or structs, as if it is the current (i.e.&nbsp;{}self{}). So, returning to our original problem, to move all instances of the ball object 8 pixels down you would type:":"一旦表达式设置了{}with{}的范围，就会针对每个指定的实例或结构执行{}语句{}，就像它是当前实例或结构一样(即{}self{})。因此，回到我们最初的问题，要将球对象的所有实例向下移动 8 个像素，您可以输入：","Once the expression has set the scope of the {}with{}, the {}statement{} will then be executed for each of the indicated instances, as if that instance is the current ( {}self{}) instance. So, returning to our original problem, to move all instances of the ball object 8 pixels down you would type:":"一旦表达式设置了 {}with{} 的范围，就会为每个指定的实例执行 {}语句{}，就像该实例是当前 ({}self{}) 实例一样。因此，回到我们最初的问题，要将球对象的所有实例向下移动 8 个像素，您可以键入：","One of the special&nbsp;{}keywords{}&nbsp;({}self{}, {}other{},&nbsp;{}all{} or {}noone{}).":"特殊{}关键字{}之一({}self{}、{}other{}、{}all{}或{}noone{})。","One or more instances to perform the code on: a single {}{}Object Instance{}{}, an&nbsp;{}{}Object Asset{}{} (which indicates that&nbsp;{}all instances{}&nbsp;of this object in the room are to run the code block).":"要在其上执行代码的一个或多个实例：单个{}{}对象实例{}{}、{}{}对象资产{}{}(表示房间中该对象的{}所有实例{}是运行代码块)。","One or more structs, or the keyword {}global{} to access the&nbsp;{}The Global Struct{}.":"一个或多个结构体，或用于访问{}全局结构体{}的关键字{0}global{1}。","Quite a few&nbsp;{}instance functions{}&nbsp;return either an {}{}Object Instance{}{}&nbsp;or {}noone{}. This makes them convenient to use in combination with the {}with{} statement:&nbsp;":"相当多的 {} 实例函数 {} 返回 {}{} 对象实例 {}{} 或 {}noone{}。这使得它们可以方便地与 {}with{} 语句结合使用：","So - for example -&nbsp;to move all balls to the position of the current instance that actually contains the code, you can type this:":"因此，例如，要将所有球移动到实际包含代码的当前实例的位置，您可以键入以下内容：","Specific Uses":"具体用途",Syntax:"句法",'The "other" Instance or Struct':'"其他"实例或结构',"The above code is slightly more complex than previous ones due to it using a {}local variable{}. This variable is {}local {}to either the {}event{}&nbsp;or the {}script&nbsp;{}{}function{}&nbsp;and not to the instance or struct and so can be used and accessed by all instances that are referenced within the code block. So, in the code above we have set a local variable to the special&nbsp;keyword {}noone{} and then use the {}with{} construction to have every instance of&nbsp;{}obj_ball{}&nbsp;check their&nbsp;{}str{}&nbsp;variable against that of the instance running the code block. If the value of the variable is larger, then they store their unique ID in the&nbsp;{}inst{}&nbsp;local variable, meaning that at the end of the code, only the instance with a value greater than the calling instance (or the&nbsp;keyword&nbsp;{}noone{}&nbsp;if none are larger) will be stored in the local variable {}_inst{}.":"由于使用了 {} 局部变量 {}，上述代码比之前的代码稍微复杂一些。该变量是 {} 事件 {} 或 {} 脚本 {}{} 函数 {} 的 {2} 本地 {3} 变量，而不是实例或结构的本地变量，因此可由在该变量中引用的所有实例使用和访问代码块。因此，在上面的代码中，我们将局部变量设置为特殊关键字 {}noone{}，然后使用 {}with{} 构造让 {}obj_ball{} 的每个实例检查其 {}str{} 变量运行代码块的实例的值。如果变量的值较大，则它们会将其唯一 ID 存储在 {}inst{} 局部变量中，这意味着在代码末尾，仅存储值大于调用实例 (或关键字 {}noone{}( 如果没有更大的) 将存储在局部变量 {}_inst{} 中。","The above code is slightly more complex than previous ones due to it using a {}local variable{}. This variable is {}local {}to either the {}event{}&nbsp;or the {}script&nbsp;{}{}function{}&nbsp;and not to the instance or struct and so can be used and accessed by all instances that are referenced within the code block. So, in the code above we have set a local variable to the special&nbsp;keyword&nbsp;{}noone{}&nbsp;and then use the&nbsp;{}with{}&nbsp;construction to have every instance of&nbsp;{}obj_Ball{}&nbsp;check their&nbsp;{}str{}&nbsp;variable against that of the instance running the code block. If the value of the variable is larger, then they store their unique ID in the&nbsp;{}inst{}&nbsp;local variable, meaning that at the end of the code, only the instance with a value greater than the calling instance (or the&nbsp;keyword&nbsp;{}noone{}&nbsp;if none are larger) will be stored in the local variable {}_inst{}.":"上面的代码比之前的代码稍微复杂一些，因为它使用了一个{}局部变量{}。这个变量对{}事件{}或{}脚本{}{} 函数{}而言是{}局部 {}，而不是对实例或结构而言，因此可以被代码块中引用的所有实例使用和访问。因此，在上面的代码中，我们将一个局部变量设置为特殊的关键字{}noone{}，然后使用{}with{}结构让{}obj_Ball{}的每个实例对照运行代码块的实例检查其{}str{}变量。如果变量的值更大，那么他们就会将自己的唯一ID存储在{}inst{}本地变量中，这意味着在代码结束时，只有值大于调用实例的实例（或者如果都不大则是关键字{}noone{}）会被存储在本地变量{}_inst{}中。","The above code loops through the instances in the room of an object {}obj_enemy{} and sets the variable {}hp{} to 100 for the first 10 it finds. If any more than 10 instances exist, the with code will call {}break{} and end.":"上述代码循环遍历对象{}obj_enemy{}房间中的实例，并将找到的前 10 个实例的变量{}hp{}设置为 100。如果存在超过 10 个实例，with 代码将调用{}break{}并结束。","The above code loops through the instances in the room of the object {}obj_Enemy{} and sets the variable {}hp{} to 100 for the first 10 it finds. If any more than 10 instances exist, the with code will call {}break{} and end.":"上面的代码循环遍历对象 {}obj_Enemy{} 房间中的实例，并将找到的前 10 个变量 {}hp{} 设置为 100。如果存在超过 10 个实例，with 代码将调用 {}break{} 并结束。","The above code uses {}with{} to target a struct and set the given struct member variables to the values stored in the instance variables from the instance calling the code.":"上面的代码使用 {}with{} 来定位结构并将给定的结构成员变量设置为存储在调用代码的实例的实例变量中的值。","The above code will create an instance of {}obj_Ball{} and assign it the speed and direction of the instance that runs the whole code block.":"上述代码将创建一个 {}obj_Ball{} 实例，并为其分配运行整个代码块的实例的速度和方向。","The above code will create an instance of {}obj_ball{} and assign it the speed and direction of the instance that runs the whole code block.":"上述代码将创建一个{}obj_ball{}实例，并为其分配运行整个代码块的实例的速度和方向。","The above code will destroy the instance of {}obj_Ball{} nearest to the instance running the code.":"上述代码将销毁离运行代码的实例最近的 {}obj_Ball{} 实例。","The above code will destroy the instance of {}obj_ball{} nearest to the instance running the code.&nbsp;When no instance is found, the function returns {}noone{}&nbsp;so that the code inside the&nbsp;{}{}with{}{}&nbsp;isn't executed.":"上述代码将销毁距离运行该代码的实例最近的 {}obj_ball{} 实例。如果未找到实例，该函数将返回 {}noone{}，以便不执行 {}{}with{}{} 内的代码。","The {}expression{}&nbsp;can take a number of different inputs:":"{}表达式{}可以接受多个不同的输入：","The {}with{} statement is an extremely powerful tool and is useful in many, many circumstances so it is important that you understand fully how it can be used. To help there are a few more examples of use below:":"{}with{} 语句是一个极其强大的工具，在很多情况下都很有用，因此您必须充分了解如何使用它。为了提供帮助，下面还有一些使用示例：","The {}{}with{}{} statement takes the form:":"{}{}with{}{}语句采用以下形式：","The&nbsp;{}{}with{}{}&nbsp;statement essentially performs a loop. Depending on the result of the expression, the statements inside the curly brackets {}{&nbsp;}{} will either be not executed at all, executed a single time or multiple times:&nbsp;":"{}{}with{}{}语句本质上执行一个循环。根据表达式的结果，大括号{}{ }{}内的语句将根本不执行、执行一次或多次：","This code will loop through all instance with the parent {}obj_Enemy_Parent{}, then checks each instance to see if the {}invulnerable{} instance variable is {}true{} or not. If it is, the {}continue{} keyword ends the current iteration of the loop and moves on to the next available instance, otherwise it removes 25 from the {}hp{} variable. This will repeat until all instances with that parent have been checked.":"这段代码将循环所有父代{}obj_Enemy_Parent{}的实例，然后检查每个实例，看{}invulnerable{}实例变量是否为{}true{}。如果是，{}continue{}关键字将结束当前的循环迭代，并进入下一个可用的实例，否则将从{}hp{}变量中删除25。这将重复进行，直到所有具有该父类的实例都被检查过。","This code will loop through all instances with the parent {}obj_enemy_parent{}, then checks each instance to see if the {}invulnerable{} instance variable is {}true{} or not. If it is, the {}continue{} keyword ends the current iteration of the loop and moves on to the next available instance, otherwise it removes 25 from the {}hp{} variable. This will repeat until all instances with that parent have been checked.":"此代码将循环遍历具有父级{}obj_enemy_parent{}的所有实例，然后检查每个实例以查看{}invulnerable{}实例变量是否为{}true{}。如果是，则{}continue{}关键字结束循环的当前迭代并移至下一个可用实例，否则它会从{}hp{}变量中删除 25。这将重复，直到检查了具有该父级的所有实例。","This will then change the&nbsp;{}scope{} of the code within the curly brackets {}{ }{} from the instance, struct or function that executes the&nbsp;{}{}with{}{} to the instance (or instances or struct) given in the expression.":"然后，这会将大括号{2}{ }{3}内的代码的{}范围{}从执行{}{}with{}{}的实例、结构或函数更改为实例(或实例或结构))在表达式中给出。","When it receives an&nbsp;{}{}Object Asset{}{}&nbsp;or the keyword {}all{},&nbsp;it runs the code multiple times: every&nbsp;{}iteration{}&nbsp;of the loop will run on one instance of the object or on all instances, respectively.":"当它收到{}{}对象资源{}{}或关键字{}all{}时，它会多次运行代码：循环的每次{}迭代{}将在对象的一个​​实例或所有实例上运行分别是实例。","When it receives an&nbsp;{}{}Object Instance{}{}, a&nbsp;{}{}Struct{}{} or one of the keywords {}self{},&nbsp;{}other{}&nbsp;or {}global{}, it runs the code once, for the instance or struct being referenced.":"当它收到{}{}对象实例{}{}、{}{}结构{}{}或关键字{}self{}、{}other{}或{}global{}之一时，它会运行对于被引用的实例或结构，代码一次。",'When {}with{} receives {}noone{}, it executes 0 times, i.e. it runs the code for "no one".':'当{}with{}接收到{}noone{}时，它会执行 0 次，即运行"noone"的代码。',"With as a Loop":"作为循环","it will have exactly the same effect because it is simply an abbreviation of the first statement. So how {}do{} we achieve something like this? This is why the {}with{} statement exists in GML. The {}with{} statement has the following syntax:":"它将具有完全相同的效果，因为它只是第一条语句的缩写。那么我们{}如何{}实现这样的目标呢？这就是 GML 中存在 {}with{} 语句的原因。 {}with{} 语句具有以下语法：","it will have exactly the same effect because it is simply an abbreviation of the first statement. So how {}do{} we achieve something like this? This is why the&nbsp;{}{}with{}{} statement exists in GML.":"它将具有完全相同的效果，因为它只是第一个语句的缩写。那么我们{}如何{}实现这样的目标？这就是 GML 中存在{}{}with{}{}语句的原因。","{}NOTE{}&nbsp;Instances in a room are created in a certain {}order{}, and their Create events are also executed as they are created one-by-one. This means that you must be careful when reading variables from other instances in the Create event, as that other instance may not have run its Create event yet!{} {} For example: let's say {}ObjectA{} is created before {}ObjectB{}, and you have the following code in those objects' Create events:{} {} {}ObjectA {}Create -&nbsp;{}myValue = objectB.myValue;{}{} {}ObjectB {}Create -&nbsp;{}myValue = 10;{}{} {} ObjectA is created first and its Create event runs, which then crashes the game:{} {} {}{}\"Variable objectB.myValue(100003, -2147483648) not set before reading it.\"{}{}{} {} That's simply because ObjectB has not even been created yet, so any variables initialised in its Create event do not yet exist. This is why you must take caution when referencing other instances&nbsp;like this in the Create event, including any code run inside {}{}with(){}{} blocks. ":"{}注意{}房间中的实例是按照特定的{}顺序{}创建的，它们的创建事件也会在一个接一个创建时执行。这意味着您在从 创建事件中的其他实例读取变量时必须小心，因为其他实例可能尚未运行其 创建事件！{}{}例如：假设 {}ObjectA{} 在 {}ObjectB{} 之前创建，并且您在这些对象的创建事件中有以下代码：{}{}{}ObjectA {}创建 -{}myValue = objectB.myValue;{}{}{}ObjectB {}创建 -{}myValue = 10;{}{}{}首先创建 ObjectA 并运行其 Create 事件，然后导致游戏崩溃：{}{}{}{}“变量 objectB.myValue(100003, -2147483648) 在读取之前未设置。”{}{}{}{}这仅仅是因为 ObjectB 甚至还没有被创建，所以在它的 创建事件中初始化的任何变量都不存在。这就是为什么在 创建事件中引用其他类似实例时必须小心，包括在 {}{}with(){}{} 块内运行的任何代码。","{}other{}":"","{}{}TIP{}{}&nbsp;If you simply need to assign values to the new instance's variables, you can pass them through&nbsp;the{}var_struct{} parameter of&nbsp;{}{}instance_create_layer{}{}&nbsp;/&nbsp;{}{}instance_create_depth{}{}.":"{}{}提示{}{}如果您只需为新实例的变量赋值，您可以通过{}{}instance_create_layer{}{}/{}{}instance_create_depth{}{}的{4}var_struct{5}参数传递它们。"},get_json_global=$.ajax({url:"/global.json",type:"GET",dataType:"json",async:!1,success:function(e){json_global=e}});$(function(){if(addNoTranslationStateButton(),noTranslationState())return!1;$("div.footer a,h4,caption").each(function(){setTranslator($(this),json_global)}),$("p,h1,h2,h3,td,li,a,div.dropspotnote,figcaption").each(function(){setTranslator($(this),json_file)}),$("th,.warning,.important,.optional").each(function(){setTranslator($(this),json_global)}),$(".header").length&&(window.setInterval(function(){$("#toc-panel a:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)}),$(".GlossDefinitionText:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)})},250),console.log("成功啦!现在正在疯狂翻译菜单中!")),$(".tooltip").each(function(){setTranslator($(this),json_global,"title")})}),document.addEventListener("DOMContentLoaded",()=>{pangu.autoSpacingPage()})</script><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../../..",gTopicId="8.2.1.3.0_9"</script><script type="text/javascript" src="../../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>with</title><meta name="generator" content="Adobe RoboHelp 2022"><link rel="stylesheet" href="../../../assets/css/default.css" type="text/css"><script src="../../../assets/scripts/main_script.js" type="module"></script><meta name="rh-authors" content="Mark Alexander"><meta name="topic-comment" content="Page outlining the with function"><meta name="rh-index-keywords" content="with"><meta name="search-keywords" content="with"><meta name="brsnext" value="GameMaker_Language/GML_Overview/Language_Features/return.htm"><meta name="brsprev" value="GameMaker_Language/GML_Overview/Language_Features/exit.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="with"><span>with</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><h1><span data-field="title" data-format="default">with</span></h1><p>As indicated in the section <a href="../Addressing_Variables_In_Other_Instances.htm">Addressing Variables in Other Instances</a>, it is possible to read and change the value of variables in instances and <a href="../Structs.htm">structs</a> other than the one currently executing any given code. However, in a number of cases you want to do a lot more than just change a single variable within those other instances, and may want to perform more complex code actions that require multiple functions and lines of code. For example, imagine that you want to move all the instances of a ball object in your game 8 pixels down. You may think that this is achieved simply by the following piece of code:</p><p class="code">obj_ball.y = obj_ball.y + 8;</p><p>But this is not correct, as the right-hand side of the assignment gets the value of the y-coordinate of the first ball and adds 8 to it. Next this new value is set as the y-coordinate of <em>all</em> balls, so the result is that all balls get the same y-coordinate, and even if you use the following:</p><p class="code">obj_ball.y += 8;</p><p>it will have exactly the same effect because it is simply an abbreviation of the first statement. So how <i>do</i> we achieve something like this? This is why the&nbsp;<span class="inline2"><span data-field="title" data-format="default">with</span></span> statement exists in GML.</p><h2 id="syntax">Syntax</h2><p>The <span class="inline2"><span data-field="title" data-format="default">with</span></span> statement takes the form:</p><p class="code"><span data-field="title" data-format="default">with</span>&nbsp;(&lt;expression&gt;)<br>{<br>&nbsp; &nbsp; &lt;statement&gt;;<br>&nbsp; &nbsp; &lt;statement&gt;;<br>&nbsp; &nbsp; ...<br>}</p><p>The <a class="tooltip" title="An expression is a combination of one or more constants, variables, operators, and/or functions that are interpreted according to particular rules of precedence and association to return another value. A simple expression would be (5 + 5), which returns 10.">expression</a>&nbsp;can take a number of different inputs:</p><ul class="colour"><li>One or more instances to perform the code on: a single <span data-keyref="Type_ID_Instance"><a target="_blank" href="../../GML_Reference/Asset_Management/Instances/Instance_Variables/id.htm">Object Instance</a></span>, an&nbsp;<span data-keyref="Type_Asset_Object"><a target="_blank" href="../../../The_Asset_Editors/Objects.htm">Object Asset</a></span> (which indicates that&nbsp;<i>all instances</i>&nbsp;of this object in the room are to run the code block).</li><li>One or more structs, or the keyword <span class="inline2">global</span> to access the&nbsp;<a href="../Variables/Global_Variables.htm#the_global_struct">The Global Struct</a>.</li><li>One of the special&nbsp;<a href="../Instance_Keywords.htm">keywords</a>&nbsp;(<span class="inline2">self</span>, <span class="inline2">other</span>,&nbsp;<span class="inline2">all</span> or <span class="inline2">noone</span>).</li></ul><p>This will then change the&nbsp;<a href="../Variables_And_Variable_Scope.htm">scope</a> of the code within the curly brackets <span class="inline2">{ }</span> from the instance, struct or function that executes the&nbsp;<span class="inline2"><span data-field="title" data-format="default">with</span></span> to the instance (or instances or struct) given in the expression.</p><p>Once the expression has set the scope of the <span class="inline2">with</span>, the <a class="tooltip" title="In programming, a statement is a single line of code written legally in a programming language that expresses an action to be carried out. A statement might have internal components of its own, including expressions, operators and functions. An example of a statement is A = B + 5. A GameMaker Studio 2 program is nothing but a sequence of one or more statements that together perform a task (like move the player). ">statement</a> will then be executed for each of the indicated instances or structs, as if it is the current (i.e.&nbsp;<span class="inline2">self</span>). So, returning to our original problem, to move all instances of the ball object 8 pixels down you would type:</p><p class="code">with (obj_ball)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;y += 8;<br>}</p><hp></hp><p>If you want to execute multiple statements, just include them in the curly brackets, the same as you would around any other code block. So for example, to move all the balls in our example to a random position and give them a random speed and direction, you would use:</p><p class="code">with (obj_ball)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;x = random(room_width);<br>&nbsp;&nbsp;&nbsp;&nbsp;y = random(room_height);<br>&nbsp;&nbsp;&nbsp;&nbsp;speed = 1 + random(2);<br>&nbsp;&nbsp;&nbsp;&nbsp;direction = random(360);<br>}</p><p>&nbsp;</p><div data-conref="../../../assets/snippets/Instance_creation_order_warning.hts"><p class="note"><span class="note">NOTE</span>&nbsp;Instances in a room are created in a certain <a href="../../../The_Asset_Editors/Room_Properties/Room_Properties.htm#creation_order">order</a>, and their Create events are also executed as they are created one-by-one. This means that you must be careful when reading variables from other instances in the Create event, as that other instance may not have run its Create event yet!<br><br>For example: let's say <strong>ObjectA</strong> is created before <strong>ObjectB</strong>, and you have the following code in those objects' Create events:<br><br><strong>ObjectA</strong> Create -&nbsp;<span class="inline2">myValue = objectB.myValue;</span><br><strong>ObjectB</strong> Create -&nbsp;<span class="inline2">myValue = 10;</span><br><br>ObjectA is created first and its Create event runs, which then crashes the game:<br><br><em><strong>"Variable objectB.myValue(100003, -2147483648) not set before reading it."</strong></em><br><br>That's simply because ObjectB has not even been created yet, so any variables initialised in its Create event do not yet exist. This is why you must take caution when referencing other instances&nbsp;like this in the Create event, including any code run inside <span class="inline"><a href="with.htm">with()</a></span> blocks.</p></div><p>&nbsp;</p><h2 id="with_as_a_loop">With as a Loop</h2><p>The&nbsp;<span class="inline2"><span data-field="title" data-format="default">with</span></span>&nbsp;statement essentially performs a loop. Depending on the result of the expression, the statements inside the curly brackets <span class="inline2">{&nbsp;}</span> will either be not executed at all, executed a single time or multiple times:&nbsp;</p><ul class="colour"><li>When <span class="inline2">with</span> receives <span class="inline2">noone</span>, it executes 0 times, i.e. it runs the code for "no one".</li><li>When it receives an&nbsp;<span data-keyref="Type_ID_Instance"><a target="_blank" href="../../GML_Reference/Asset_Management/Instances/Instance_Variables/id.htm">Object Instance</a></span>, a&nbsp;<span data-keyref="Type_Struct"><a target="_blank" href="../Structs.htm">Struct</a></span> or one of the keywords <span class="inline2">self</span>,&nbsp;<span class="inline2">other</span>&nbsp;or <span class="inline2">global</span>, it runs the code once, for the instance or struct being referenced.</li><li>When it receives an&nbsp;<span data-keyref="Type_Asset_Object"><a target="_blank" href="../../../The_Asset_Editors/Objects.htm">Object Asset</a></span>&nbsp;or the keyword <span class="inline2">all</span>,&nbsp;it runs the code multiple times: every&nbsp;<a class="tooltip" title="An iteration is a single pass through a set of operations in your project code. One form of iteration in computer programming is via loops. A loop will repeat a certain segment of code until a condition is met and it can proceed further. Each time the computer runs a loop, it is known as an iteration. In simple terms, iteration is the process of repeating a particular snippet of code over and over again to perform a certain action.">iteration</a>&nbsp;of the loop will run on one instance of the object or on all instances, respectively.</li></ul><p>Because&nbsp;<span class="inline2"><span data-field="title" data-format="default">with</span></span>&nbsp;behaves as a loop, you can use the special <span class="inline2"><a href="break.htm">break</a></span> and <span class="inline2"><a href="continue.htm">continue</a></span> statements in it as well. Using <span class="inline2">break</span> will immediately exit the&nbsp;<span class="inline2"><span data-field="title" data-format="default">with</span></span> code block and move on to any code that is in the event or function after the <span class="inline2">with</span> should have finished, e.g.:</p><p class="code">var _count = 0;<br>with (obj_enemy)<br>{<br>&nbsp; &nbsp; if (++_count &gt; 10)<br>&nbsp; &nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp; &nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;hp = 100;<br>}</p><p>The above code loops through the instances in the room of an object <span class="inline2">obj_enemy</span> and sets the variable <span class="inline2">hp</span> to 100 for the first 10 it finds. If any more than 10 instances exist, the with code will call <span class="inline2">break</span> and end.</p><p>An example of using <span class="inline2">continue</span> in a <span class="inline2">with</span>&nbsp;loop would be:</p><p class="code">with (obj_enemy_parent)<br>{<br>&nbsp; &nbsp; if (invulnerable == true)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; continue;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; hp -= 25;<br>}</p><p>This code will loop through all instances with the parent <span class="inline2">obj_enemy_parent</span>, then checks each instance to see if the <span class="inline2">invulnerable</span> instance variable is <span class="inline2">true</span> or not. If it is, the <span class="inline2">continue</span> keyword ends the current iteration of the loop and moves on to the next available instance, otherwise it removes 25 from the <span class="inline2">hp</span> variable. This will repeat until all instances with that parent have been checked.</p><h2 id="specific_uses">Specific Uses</h2><h3>The "other" Instance or Struct</h3><p>As mentioned above, within the statement(s), the indicated instance or struct&nbsp;has become the target (<span class="inline2">self</span>) instance that runs the code block, which means that the original instance (that contains the&nbsp;<span class="inline2"><span data-field="title" data-format="default">with</span></span> and the entire code block) has become the <a href="../Instance_Keywords.htm"><span class="inline">other</span></a> instance.</p><p>So - for example -&nbsp;to move all balls to the position of the current instance that actually contains the code, you can type this:</p><p class="code">with (obj_ball)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;x = other.x;<br>&nbsp;&nbsp;&nbsp;&nbsp;y = other.y;<br>}</p><h3>Executing Code in a New Instance</h3><p class="code">with (instance_create_layer(x, y, "Instances", obj_ball))<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;speed = other.speed;<br>&nbsp;&nbsp;&nbsp;&nbsp;direction = other.direction;<br>}</p><p>The above code will create an instance of <span class="inline2">obj_ball</span> and assign it the speed and direction of the instance that runs the whole code block.</p><p class="note"><span data-conref="../../../assets/snippets/Tag_tip.hts"><span class="tip">TIP</span></span>&nbsp;If you simply need to assign values to the new instance's variables, you can pass them through&nbsp;the<span class="inline2">var_struct</span> parameter of&nbsp;<span class="inline3_func"><a href="../../GML_Reference/Asset_Management/Instances/instance_create_layer.htm">instance_create_layer</a></span>&nbsp;/&nbsp;<span class="inline3_func"><a href="../../GML_Reference/Asset_Management/Instances/instance_create_depth.htm">instance_create_depth</a></span>.</p><h3>Instance Checking Functions</h3><p>Quite a few&nbsp;<a href="../../GML_Reference/Asset_Management/Instances/Instances.htm#general">instance functions</a>&nbsp;return either an <span data-keyref="Type_ID_Instance"><a target="_blank" href="../../GML_Reference/Asset_Management/Instances/Instance_Variables/id.htm">Object Instance</a></span>&nbsp;or <span class="inline2">noone</span>. This makes them convenient to use in combination with the <span class="inline2">with</span> statement:&nbsp;</p><p class="code">with (instance_nearest(x, y, obj_ball))<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;instance_destroy();<br>}</p><p>The above code will destroy the instance of <span class="inline2">obj_ball</span> nearest to the instance running the code.&nbsp;When no instance is found, the function returns <span class="inline2">noone</span>&nbsp;so that the code inside the&nbsp;<span class="inline2"><span data-field="title" data-format="default">with</span></span>&nbsp;isn't executed.</p><h3>Assigning Struct Variables</h3><p class="code">with(clone_struct)<br>{<br>&nbsp; &nbsp; xx&nbsp;= other.x;<br>&nbsp; &nbsp; yy = other.y;<br>&nbsp; &nbsp; spd = other.speed;<br>&nbsp; &nbsp; dir = other.direction;<br>}</p><p>The above code uses <span class="inline2">with</span> to target a struct and set the given struct member variables to the values stored in the instance variables from the instance calling the code.</p><h3>Local Variable to Cross Scopes</h3><p class="code">var _inst = noone;<br>with (obj_ball)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if (str &gt; other.str)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp; &nbsp; &nbsp; &nbsp; _inst = id;<br>&nbsp; &nbsp; }<br>}<br>if (_inst != noone)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;target = _inst;<br>}</p><p>The above code is slightly more complex than previous ones due to it using a <a href="../Variables_And_Variable_Scope.htm">local variable</a>. This variable is <strong>local</strong> to either the <em>event</em>&nbsp;or the <em>script&nbsp;</em><em>function</em>&nbsp;and not to the instance or struct and so can be used and accessed by all instances that are referenced within the code block. So, in the code above we have set a local variable to the special&nbsp;keyword <span class="inline2">noone</span> and then use the <span class="inline2">with</span> construction to have every instance of&nbsp;<span class="inline2">obj_ball</span>&nbsp;check their&nbsp;<span class="inline2">str</span>&nbsp;variable against that of the instance running the code block. If the value of the variable is larger, then they store their unique ID in the&nbsp;<span class="inline2">inst</span>&nbsp;local variable, meaning that at the end of the code, only the instance with a value greater than the calling instance (or the&nbsp;keyword&nbsp;<span class="inline2">noone</span>&nbsp;if none are larger) will be stored in the local variable <span class="inline2">_inst</span>.</p><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div style="float:left">Back: <a href="../Language_Features.htm">Language&nbsp;Features</a></div><div style="float:right">Next: <a href="return.htm">return</a></div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div><p>&nbsp;</p><p><br>&nbsp;</p><p>&nbsp;</p></body></html>
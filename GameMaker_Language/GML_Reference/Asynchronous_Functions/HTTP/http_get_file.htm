<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" src="../../../../assets/import/jquery-3.6.1.min.js"></script><script type="text/javascript" src="../../../../assets/import/layer/layer.js"></script><script type="text/javascript" src="../../../../assets/import/pangu.min.js"></script><link rel="stylesheet" type="text/css" href="../../../../assets/import/layer/layui_btn.css"><link rel="stylesheet" type="text/css" href="../../../../assets/import/layer/layui_col.css"><link rel="stylesheet" type="text/css" href="../../../../assets/import/layer/theme/default/layer.css"><link rel="stylesheet" type="text/css" href="../../../../assets/import/main.css"><script>let str;removeHtml=function(e){return e=(e=(e=(e=e.replace(/(<([^>]+)>)/gi,"{}")).replace(/\r\n/g,"\n")).replace(/\n/g,"")).replace(/ {2,}/g," ")},retHtml=function(e){return e.match(/(<([^>]+)>)/gi)},setTranslator=function(e,t,o){let n;n=o?e.attr(o):e.html();let i=t[removeHtml(n)];if(null!=i&&i.length){t=retHtml(n);let a=0;t&&t.forEach(function(e,t){var o=i.replace("{"+a+"}",e);i=o===i?i.replace("{}",e):o,a++}),o?e.attr(o,i):e.html(i)}},noTranslationState=function(){return"true"==window.localStorage.getItem("noTranslationState")},noTranslationStateToggle=function(){window.localStorage.setItem("noTranslationState",!noTranslationState())},addNoTranslationStateButton=function(){var e=`
		
		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		window.location.replace('gmmt://'+document.location.hash)
		"
		>打开编辑器</button>

		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		noTranslationStateToggle();
		location.reload();
    	event.stopPropagation();
		"
		>切换翻译</button>
		`;$(".header").length?$(".header").append(e):($(".topic-header").append(e),$(".topic-header button").css("position","relative").css("top","44px"))},removeExtensionFromHash=function(e){return e.replaceAll("#t=","").replaceAll("%2F","/").replaceAll(".htm","")};let json_global,json_file={'If there are multiple packets being returned to your game, the callback "status" key will return 1, in which case the DS map will have the following additional keys:':"如果有多个数据包返回到您的游戏，回调“status”键将返回 1，在这种情况下，DS 地图将具有以下附加键：",'The above code will first check the "id" of the ds_map that has been created, then check the status of the callback. If the value is equal to 0 (signalling success) the result from the callback will then be used along with the {}{}zip_unzip(){}{} function to unzip the downloaded file to the given directory. If the unzip succeeds a global variable is set to true.':"上面的代码将首先检查已创建的 ds_map 的“id”，然后检查回调的状态。 如果该值等于 0(表示成功)，回调的结果将与 {}{}zip_unzip(){}{} 函数一起使用，将下载的文件解压缩到给定目录。 如果解压缩成功，全局变量将设置为 true。",'The above code will request a file from the given URL and set it to be downloaded to the local storage area (as specified in the HTML5 Game Options), in a directory "Downloads" with the given file name (this does not have to be the same as the source file name, but should use the same file extension). The {}async_load{} map index will be stored in the variable "file" so you can check for the correct callback in the Asynchronous Event, and if the save directory does not exist, it will be created. The Asynchronous Event triggered would be the {}HTTP{} sub-event, and in that event you would have something like the following:':"上面的代码将从给定的 URL 请求一个文件，并将其设置为下载到本地存储区域(如 HTML5 游戏选项中指定的那样)，在具有给定文件名的目录“下载”中(这不一定是 与源文件名相同，但应使用相同的文件扩展名)。 {}async_load{} 地图索引将存储在变量“文件”中，因此您可以在异步事件中检查正确的回调，如果保存目录不存在，则会创建它。 触发的异步事件将是 {}HTTP{} 子事件，在那种情况下，您会遇到类似以下内容的事件：","The local storage path to save the file to":"要将文件保存到的本地存储路径","The web address of the server that you wish to get file from":"您希望从中获取文件的服务器的 Web 地址","The {}http_get_file(){} function can be called from any event, and since it is asynchronous the callback can be almost instantaneous or could take several seconds. Calling the function is simple and would look something like this:":"{}http_get_file(){} 函数可以从任何事件调用，并且由于它是异步的，回调几乎可以是即时的，也可能需要几秒钟。 调用函数很简单，看起来像这样：",'This event will generate a "call back" which is picked up by any {}HTTP Events{}, in which case it will generate a {}{}DS Map{}{} (more commonly known as a "dictionary") that is exclusive to this event and is stored in the special variable {}{}async_load{}{}. This DS map will contain different values depending on the data being returned, ie: the event will trigger multiple times as each packet of data is received so that you can show a progress bar, for example. The general structure for the DS map&nbsp;will be as follows:':"此函数将生成多个“回调”，这些回调由任何 {}HTTP 事件{}获取。 这些将生成专用于该事件并存储在特殊变量 {}{}async_load{}{} 中的 {}{}DS map{}{}(通常称为“字典”)。 根据是否有数据返回，此 DS 映射将包含不同的值。 例如，如果您请求了一个文件，该事件将在收到每个数据包时触发多次，以便您可以显示进度条等。 DS 映射的一般结构如下：","With this function, you can connect to the specified URL in order to retrieve information in the form of a file. As this is an asynchronous function, {}GameMaker{} will not block while waiting for a reply, but will keep on running unless it gets callback information. This information will be in the form of a string and will trigger an {}Async Event{} in any instance that has one defined in their object properties.":"使用此函数，您可以连接到指定的 URL，以便以文件的形式检索信息。 由于这是一个异步函数，{}GameMaker{} 在等待回复时不会阻塞，而是会继续运行，除非它获得回调信息。 此信息将采用字符串形式，并会在对象属性中定义的任何实例中触发{}异步事件{}。",'{}"contentLength": {}This is the size of file that the web server has said you should expect to receive (may be -1 if the server does not return this data).':'{}"contentLength"：{}这是网络服务器表示您应该预期收到的文件大小(如果服务器不返回此数据，则可能为 -1)。','{}"sizeDownloaded": {}The size of the data that has already been downloaded.':'{}"sizeDownload": {}已下载的数据的大小。','{}http_status: {}The raw http status code (if available). This returns the standard web status code for most browsers, eg: 304 for "Not Modified" or 204 for "No Content", etc...':"{}http_status：{}原始 http 状态代码(如果可用)。 这将返回大多数浏览器的标准 Web 状态代码，例如：304 未修改(Not Modified) ，204无内容(No Content),等等...","{}id: {}The ID which was returned from the command. If you fire off a series of {}http_{} requests then you need to know which one you are getting the reply to, and so you would use this value to compare to the value you stored when you originally sent the request to find the right one.":"{}id：{}从命令返回的 ID。 如果您发出一系列 {}http_{} 请求，那么您需要知道您收到的是哪个请求的回复，因此您将使用此值与您最初发送请求时存储的值进行比较，以找到 正确的那一个。","{}result: {}The data received (string only).":"{}result 结果: {}收到的数据(仅字符串)。","{}status: {}Returns a value of less than 0 for an error, 0 for complete and 1 for receiving packets (see below for more details).":"{}status 状态：{}返回小于 0 的值表示错误，0 表示完成，1 表示接收数据包(详情请见下文)。","{}url: {}The complete URL you requested.":"{}url : {}请求的完整 URL。","{}{}NOTE{} {}You should be aware that due to XSS protection in browsers, requests to and attempts to load resources from across domains are blocked and may appear to return blank results. Please see the part on {}Cross Domain Issues{} for further details.":"{}{}注意{} {}您应该知道，由于浏览器中的 XSS 保护，跨域请求和加载资源的尝试会被阻止，并且可能会返回空白结果。 有关更多详细信息，请参阅{}跨域问题{}部分。"},get_json_global=$.ajax({url:"/global.json",type:"GET",dataType:"json",async:!1,success:function(e){json_global=e}});$(function(){if(addNoTranslationStateButton(),noTranslationState())return!1;$("div.footer a,h4,caption").each(function(){setTranslator($(this),json_global)}),$("p,h1,h2,h3,td,li,a,div.dropspotnote,figcaption").each(function(){setTranslator($(this),json_file)}),$("th,.warning,.important,.optional").each(function(){setTranslator($(this),json_global)}),$(".header").length&&(window.setInterval(function(){$("#toc-panel a:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)}),$(".GlossDefinitionText:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)})},250),console.log("成功啦!现在正在疯狂翻译菜单中!")),$(".tooltip").each(function(){setTranslator($(this),json_global,"title")})}),document.addEventListener("DOMContentLoaded",()=>{pangu.autoSpacingPage()})</script><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../../../..",gTopicId="8.2.2.14.1.0_3"</script><script type="text/javascript" src="../../../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>http_get_file</title><meta name="generator" content="Adobe RoboHelp 2022"><link rel="stylesheet" href="../../../../assets/css/default.css" type="text/css"><script src="../../../../assets/scripts/main_script.js" type="module"></script><meta name="rh-authors" content="Mark Alexander"><meta name="topic-comment" content="Reference page for http_get_file"><meta name="rh-index-keywords" content="http_get_file"><meta name="search-keywords" content="http_get_file"><meta name="brsnext" value="GameMaker_Language/GML_Reference/Asynchronous_Functions/HTTP/http_post_string.htm"><meta name="brsprev" value="GameMaker_Language/GML_Reference/Asynchronous_Functions/HTTP/http_get.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="http_get_file"><span>http_get_file</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><h1>http_get_file</h1><p>With this function, you can connect to the specified URL in order to retrieve information in the form of a file. As this is an asynchronous function, <span data-keyref="GameMaker Name">GameMaker</span> will not block while waiting for a reply, but will keep on running unless it gets callback information. This information will be in the form of a string and will trigger an <b>Async Event</b> in any instance that has one defined in their object properties.</p><p class="note"><b><span class="note">NOTE</span></b> You should be aware that due to XSS protection in browsers, requests to and attempts to load resources from across domains are blocked and may appear to return blank results. Please see the part on <a href="HTTP.htm">Cross Domain Issues</a> for further details.</p><p>This event will generate a "call back" which is picked up by any <a href="../../../../The_Asset_Editors/Object_Properties/Async_Events/HTTP.htm">HTTP Events</a>, in which case it will generate a <a href="../../Data_Structures/DS_Maps/DS_Maps.htm"><span class="inline">DS Map</span></a> (more commonly known as a "dictionary") that is exclusive to this event and is stored in the special variable <a href="../../../GML_Overview/Variables/Builtin_Global_Variables/async_load.htm"><b>async_load</b></a>. This DS map will contain different values depending on the data being returned, ie: the event will trigger multiple times as each packet of data is received so that you can show a progress bar, for example. The general structure for the DS map&nbsp;will be as follows:</p><ul class="colour"><li><b>id:</b> The ID which was returned from the command. If you fire off a series of <span class="inline">http_</span> requests then you need to know which one you are getting the reply to, and so you would use this value to compare to the value you stored when you originally sent the request to find the right one.</li><li><b>status:</b> Returns a value of less than 0 for an error, 0 for complete and 1 for receiving packets (see below for more details).</li><li><b>result:</b> The data received (string only).</li><li><b>url:</b> The complete URL you requested.</li><li><b>http_status:</b> The raw http status code (if available). This returns the standard web status code for most browsers, eg: 304 for "Not Modified" or 204 for "No Content", etc...</li></ul><p>If there are multiple packets being returned to your game, the callback "status" key will return 1, in which case the DS map will have the following additional keys:</p><ul class="colour"><li><b>"contentLength":</b> This is the size of file that the web server has said you should expect to receive (may be -1 if the server does not return this data).</li><li><b>"sizeDownloaded":</b> The size of the data that has already been downloaded.</li></ul><p>&nbsp;</p><h4>Syntax:</h4><p class="code">http_get_file(url, local_target);</p><table><tbody><tr><th>Argument</th><th>Type</th><th>Description</th></tr><tr><td>url</td><td><span data-keyref="Type_String"><a target="_blank" href="../../../GML_Overview/Data_Types.htm">String</a></span></td><td>The web address of the server that you wish to get file from</td></tr><tr><td>local_target</td><td><span data-keyref="Type_String"><a target="_blank" href="../../../GML_Overview/Data_Types.htm">String</a></span></td><td>The local storage path to save the file to</td></tr></tbody></table><p>&nbsp;</p><h4>Returns:</h4><p class="code"><span data-keyref="Type_ID_Async_Event"><a target="_blank" href="../Asynchronous_Functions.htm">Async Request ID</a></span></p><p>&nbsp;</p><h4>Extended Example:</h4><p>The <span class="inline">http_get_file()</span> function can be called from any event, and since it is asynchronous the callback can be almost instantaneous or could take several seconds. Calling the function is simple and would look something like this:</p><p class="code">file = http_get_file("http://www.macsweeneygames.com/downloads/upgrade.zip", "\Downloads\Upgrade.zip");</p><p>The above code will request a file from the given URL and set it to be downloaded to the local storage area (as specified in the HTML5 Game Options), in a directory "Downloads" with the given file name (this does not have to be the same as the source file name, but should use the same file extension). The <span class="inline">async_load</span> map index will be stored in the variable "file" so you can check for the correct callback in the Asynchronous Event, and if the save directory does not exist, it will be created. The Asynchronous Event triggered would be the <b>HTTP</b> sub-event, and in that event you would have something like the following:</p><p class="code">if (ds_map_find_value(async_load, "id") == file)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;var status = ds_map_find_value(async_load, "status");<br>&nbsp;&nbsp;&nbsp;&nbsp;if (status == 0)<br>&nbsp; &nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var path = ds_map_find_value(async_load, "result");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var files = zip_unzip(path, "/NewContent/");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (files &gt; 0)<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global.ExtraContent = true;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}</p><p>The above code will first check the "id" of the ds_map that has been created, then check the status of the callback. If the value is equal to 0 (signalling success) the result from the callback will then be used along with the <a href="../../File_Handling/Encoding_And_Hashing/zip_unzip.htm"><span class="inline">zip_unzip()</span></a> function to unzip the downloaded file to the given directory. If the unzip succeeds a global variable is set to true.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div style="float:left">Back: <a href="HTTP.htm">HTTP</a></div><div style="float:right">Next:&nbsp;<a href="http_post_string.htm">http_post_string</a></div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div></body></html>
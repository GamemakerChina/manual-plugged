<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" src="../../../../../assets/import/jquery-3.6.1.min.js"></script><script type="text/javascript" src="../../../../../assets/import/layer/layer.js"></script><script type="text/javascript" src="../../../../../assets/import/pangu.min.js"></script><link rel="stylesheet" type="text/css" href="../../../../../assets/import/layer/layui_btn.css"><link rel="stylesheet" type="text/css" href="../../../../../assets/import/layer/layui_col.css"><link rel="stylesheet" type="text/css" href="../../../../../assets/import/layer/theme/default/layer.css"><link rel="stylesheet" type="text/css" href="../../../../../assets/import/main.css"><script>let str;removeHtml=function(t){return t=(t=(t=(t=t.replace(/(<([^>]+)>)/gi,"{}")).replace(/\r\n/g,"\n")).replace(/\n/g,"")).replace(/ {2,}/g," ")},retHtml=function(t){return t.match(/(<([^>]+)>)/gi)},setTranslator=function(t,n,a){let e;e=a?t.attr(a):t.html();let l=n[removeHtml(e)];if(null!=l&&l.length){n=retHtml(e);let o=0;n&&n.forEach(function(t,n){var a=l.replace("{"+o+"}",t);l=a===l?l.replace("{}",t):a,o++}),a?t.attr(a,l):t.html(l)}},noTranslationState=function(){return"true"==window.localStorage.getItem("noTranslationState")},noTranslationStateToggle=function(){window.localStorage.setItem("noTranslationState",!noTranslationState())},addNoTranslationStateButton=function(){$(".header").length&&$(".header").append(`
		
		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		window.location.replace('gmmt://'+document.location.hash)
		"
		>打开编辑器</button>

		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		noTranslationStateToggle();
		location.reload();
    	event.stopPropagation();
		"
		>切换翻译</button>
		`)},removeExtensionFromHash=function(t){return t.replaceAll("#t=","").replaceAll("%2F","/").replaceAll(".htm","")},$(function(){if(addNoTranslationStateButton(),noTranslationState())return!1;$("div.footer a,h4,caption,blockquote").each(function(){setTranslator($(this),json_global)}),$("p,h1,h2,h3,td,li,a,div.dropspotnote,figcaption,.expandtext").each(function(){setTranslator($(this),json)}),$("th,.warning,.important,.optional").each(function(){setTranslator($(this),json_global)}),$(".header").length&&(window.setInterval(function(){$("#toc-panel a:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)}),$(".GlossDefinitionText:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)})},250),console.log("成功啦!现在正在疯狂翻译菜单中!")),$(".tooltip").each(function(){setTranslator($(this),json_global,"title")})}),document.addEventListener("DOMContentLoaded",()=>{pangu.autoSpacingPage()})</script><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../../../../..",gTopicId="8.2.2.3.5.7"</script><script type="text/javascript" src="../../../../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../../../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../../../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../../../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../../../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../../../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../../../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><link rel="stylesheet" type="text/css" href="../../../../../assets/css/default.css"><script src="../../../../../../assets/scripts/main_script.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="Adobe RoboHelp 2022"><title>Audio Loop Points</title><meta name="topic-status" content="Draft"><link rel="stylesheet" type="text/css" href="../../../../../assets/css/default.css"><meta name="rh-authors" content="Bart Teunis"><meta name="topic-comment" content="Reference page for the audio loop points feature"><meta name="template" content="../../../../../assets/masterpages/Manual_Page.htt"><meta name="search-keywords" content="audio,loop,loop points"><meta name="rh-index-keywords" content="audio loop points"><meta name="brsnext" value="GameMaker_Language/GML_Reference/Asset_Management/Audio/Audio_Loop_Points/audio_sound_loop.htm"><meta name="brsprev" value="GameMaker_Language/GML_Reference/Asset_Management/Audio/Audio_Synchronisation/audio_sync_group_is_paused.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="Audio Loop Points"><span>Audio Loop Points</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><div></div><div><h1><span data-field="title" data-format="default">Audio Loop Points</span></h1><p><span data-field="title" data-format="default">Audio Loop Points</span>&nbsp;allow you to loop a part (or&nbsp;section) of an audio asset.</p><p>While you can manually control audio playback using&nbsp;<span class="inline3_func"><a href="../audio_sound_get_track_position.htm">audio_sound_get_track_position</a></span>&nbsp;and&nbsp;<span class="inline3_func"><a href="../audio_sound_set_track_position.htm">audio_sound_set_track_position</a></span>, this will never be accurate for looping a section, as audio is processed at a much higher rate, e.g. 44100 or 48000 times a second (the sample rate), which is a lot more than the default game speed of 60. This means that many samples may have already played between the time you call one function and the next.</p><p>By using the functions provided for audio looping, the looping is performed on the audio thread, <em>at audio rates</em>.</p><p class="note"><span><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">NOTE</span></span>&nbsp;</span><span>You cannot use buffer-based audio queues or audio sync groups with the audio looping functions. All other kind of audio can be used without problems,<span>&nbsp;including <a href="../Audio_Buffers/Audio_Buffers.htm">buffer sounds</a> and <a href="../audio_create_stream.htm">streams</a>.&nbsp;</span></span></p><h2>Function Reference</h2><p>Here are the GML Code functions for audio looping:</p><ul class="Disc"><li><a href="audio_sound_loop.htm">audio_sound_loop</a></li><li><a href="audio_sound_get_loop.htm">audio_sound_get_loop</a></li><li><a href="audio_sound_loop_start.htm">audio_sound_loop_start</a></li><li><a href="audio_sound_get_loop_start.htm">audio_sound_get_loop_start</a></li><li><a href="audio_sound_loop_end.htm">audio_sound_loop_end</a></li><li><a href="audio_sound_get_loop_end.htm">audio_sound_get_loop_end</a></li></ul><h2>Loop Section</h2><p>Every sound asset and sound instance has a single loop section, defined by a start and end time in seconds. The part of the sound between this start and end will play looped if the sound is set to loop.</p><p>Every sound that you play using any of the <span class="inline3_func">audio_play_sound_</span> functions gets its default loop start and loop end time from the asset when played, e.g.:&nbsp;</p><p class="code">audio_sound_loop_start(snd_loop, 2);<br>audio_sound_loop_end(snd_loop, 6);<br>ins_sound = audio_play_sound(snd_loop, 100, true);<br>audio_sound_loop_end(ins_sound, 10);</p><p>By default, a sound is set to loop from the beginning to the end. This corresponds to a start value of 0.0 seconds and an end value of 0.0 seconds (corresponding to&nbsp;<span class="inline3_func"><a href="../audio_sound_length.htm">audio_sound_length</a></span>).</p><p>The loop end position <em>must</em> be after the loop start position, except when they are both set to 0.0 (i.e. loop the sound from start to end).</p><h3>Enabling/Disabling Looping</h3><p>Setting the loop state of a sound instance can be done in two ways. The first is when playing the sound using&nbsp;<span class="inline3_func"><a href="../audio_play_sound.htm">audio_play_sound</a></span>&nbsp;or any of the other <span class="inline2">audio_play_sound_</span>&nbsp;functions:&nbsp;</p><p class="code">ins_sound = audio_play_sound(snd_loop, 100, true);</p><p>The second is by calling the function&nbsp;<span class="inline3_func"><a href="audio_sound_loop.htm">audio_sound_loop</a></span>&nbsp;on an already playing sound:&nbsp;</p><p class="code">audio_sound_loop(ins_sound, true);</p><p class="note"><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">NOTE</span></span>&nbsp;When a sound's track position reaches the loop end position&nbsp;<span data-keyref="GameMaker Name">GameMaker</span>&nbsp;checks whether it should loop. If at that moment its loop state is set to <span class="inline2">true</span>, the sound will jump back to the loop start position. If not, it will continue playing the sound until the end, unless you change either the track position or the loop end.</p><h2>Examples</h2><p>The following are a couple of ways in which you can use audio loop points to loop audio.</p><h3>Intro &amp; Outro</h3><p>In this situation you have an audio file with an intro, a looping mid-section and an outro. The audio is played from the start, plays the intro part first, then moves to the looped part and keeps playing this looped until the audio is set to no longer loop. At that point the looped part will finish playing a last time to then transition to the outro part.</p><p class="code">audio_sound_loop_start(snd_music, 10);<br>audio_sound_loop_end(snd_music, 20);<br>ins_sound = audio_play_sound(snd_music, 100, true);&nbsp; // Play the sound looped</p><p>Once the sound is in the looping part, the sound instance can then be set to no longer loop:&nbsp;</p><p class="code">audio_sound_loop(ins_sound, false);</p><p>After changing this, the remainder of the looping part will be played, followed by the outro part.</p><p class="note"><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">NOTE</span></span>&nbsp;Once the sound has stopped playing <span class="inline2">ins_sound</span> will no longer refer to a valid sound instance and you will need to play a new one using&nbsp;<span class="inline3_func"><a href="../audio_play_sound.htm">audio_play_sound</a></span>.</p><h3>Multiple Loops</h3><p>Every sound has one loop section. You can add multiple loop sections yourself by storing them in a struct and manually applying the start and end of the loop section you want to use at any given moment:&nbsp;</p><p class="code">loops = [<br>&nbsp; &nbsp; {start: 0, end: 10},<br>&nbsp; &nbsp; {start: 10, end: 20},<br>&nbsp; &nbsp; {start: 20, end: 30}<br>];<br><br>section = 2;<br><br>audio_sound_loop_start(snd_several_sections, loops[section].start);<br>audio_sound_loop_end(snd_several_sections, loops[section].end);<br>ins_sound = audio_play(snd_several_sections, 200, true);</p><h3>Converting from BPM</h3><p>Using the BPM of a piece of music you can calculate the time one "beat" takes. This way you can loop parts of a sound that correspond precisely to beats or bars in the music:&nbsp;</p><p class="code">var _bpm_to_sec = time_bpm_to_seconds(126);<br>var _beats_per_bar = 4;<br>var _bars = 4;<br>audio_sound_loop_start(snd_bgm, _bars * _beats_per_bars);</p><p>This code sets the loop start position for a sound asset <span class="inline2">snd_bgm</span> to the start of the fifth bar.</p><p>See:&nbsp;</p><ul class="colour"><li><a href="../../../Time_Sources/time_bpm_to_seconds.htm">time_bpm_to_seconds</a></li><li><a href="../../../Time_Sources/time_seconds_to_bpm.htm">time_seconds_to_bpm</a></li></ul><h2>Limitations</h2><ul class="colour"><li><span>When pushing the feature to its limits (e.g. with extremely small loop-sections), compressed sounds will incur a performance penalty. In such cases, it is better to use uncompressed sound assets.</span></li></ul><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div>Back:&nbsp;<a href="../Audio.htm">Audio</a></div><div>Next:&nbsp;<a href="../Audio_Emitters/Audio_Emitters.htm">Audio Emitters</a></div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div></div></body></html>
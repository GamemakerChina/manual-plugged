<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" src="../../../../../assets/import/jquery-3.6.1.min.js"></script><script type="text/javascript" src="../../../../../assets/import/layer/layer.js"></script><script type="text/javascript" src="../../../../../assets/import/pangu.min.js"></script><link rel="stylesheet" type="text/css" href="../../../../../assets/import/layer/layui_btn.css"><link rel="stylesheet" type="text/css" href="../../../../../assets/import/layer/layui_col.css"><link rel="stylesheet" type="text/css" href="../../../../../assets/import/layer/theme/default/layer.css"><link rel="stylesheet" type="text/css" href="../../../../../assets/import/main.css"><script>let str;removeHtml=function(t){return t=(t=(t=(t=t.replace(/(<([^>]+)>)/gi,"{}")).replace(/\r\n/g,"\n")).replace(/\n/g,"")).replace(/ {2,}/g," ")},retHtml=function(t){return t.match(/(<([^>]+)>)/gi)},setTranslator=function(t,n,a){let e;e=a?t.attr(a):t.html();let l=n[removeHtml(e)];if(null!=l&&l.length){n=retHtml(e);let o=0;n&&n.forEach(function(t,n){var a=l.replace("{"+o+"}",t);l=a===l?l.replace("{}",t):a,o++}),a?t.attr(a,l):t.html(l)}},noTranslationState=function(){return"true"==window.localStorage.getItem("noTranslationState")},noTranslationStateToggle=function(){window.localStorage.setItem("noTranslationState",!noTranslationState())},addNoTranslationStateButton=function(){$(".header").length&&$(".header").append(`
		
		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		window.location.replace('gmmt://'+document.location.hash)
		"
		>打开编辑器</button>

		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		noTranslationStateToggle();
		location.reload();
    	event.stopPropagation();
		"
		>切换翻译</button>
		`)},removeExtensionFromHash=function(t){return t.replaceAll("#t=","").replaceAll("%2F","/").replaceAll(".htm","")},$(function(){if(addNoTranslationStateButton(),noTranslationState())return!1;$("div.footer a,h4,caption,blockquote").each(function(){setTranslator($(this),json_global)}),$("p,h1,h2,h3,td,li,a,div.dropspotnote,figcaption,.expandtext").each(function(){setTranslator($(this),json)}),$("th,.warning,.important,.optional").each(function(){setTranslator($(this),json_global)}),$(".header").length&&(window.setInterval(function(){$("#toc-panel a:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)}),$(".GlossDefinitionText:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)})},250),console.log("成功啦!现在正在疯狂翻译菜单中!")),$(".tooltip").each(function(){setTranslator($(this),json_global,"title")})}),document.addEventListener("DOMContentLoaded",()=>{pangu.autoSpacingPage()})</script><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../../../../..",gTopicId="8.2.2.3.5.1"</script><script type="text/javascript" src="../../../../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../../../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../../../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../../../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../../../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../../../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../../../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Audio Emitters</title><meta name="generator" content="Adobe RoboHelp 2022"><link rel="stylesheet" href="../../../../../assets/css/default.css" type="text/css"><script src="../../../../../assets/scripts/main_script.js" type="module"></script><meta name="rh-authors" content="Mark Alexander"><meta name="topic-comment" content="Page outlining the different functions and variables associated with Audio Emitters"><meta name="rh-index-keywords" content=""><meta name="search-keywords" content="Audio Emitters"><meta name="brsnext" value="GameMaker_Language/GML_Reference/Asset_Management/Audio/Audio_Emitters/audio_emitter_create.htm"><meta name="brsprev" value="GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_destroy_stream.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="Audio Emitters"><span>Audio Emitters</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><h1><span data-field="title" data-format="default">Audio Emitters</span></h1><p>Audio emitters are provided to increase the flexibility of the <span data-keyref="GameMaker Name">GameMaker</span> audio engine, and they permit you to add real time effects to your audio assets, like pitch and Doppler variations, as well as the ability to position your sounds within the 3D audio space and give them realistic motion effects. All these functions are affected by the position of the <i>listener</i> within the audio environment and so will require that you use the provided functions for changing the listener position, velocity and orientation too (see - <a href="../Audio_Listeners/Audio_Listeners.htm">Audio Listeners</a>).</p><h2>Using audio emitters and listeners</h2><p>By combining audio emitters and listeners you can create a rich, lively environment. Setting this up can be a bit involved so in this part we will look at the things that you need to do to set up a full system with emitters and the default listener.</p><h3>Setting a falloff model</h3><p>The first thing to do when working with audio emitters (and with sounds played using&nbsp;<a href="../audio_play_sound_at.htm">audio_play_sound_at</a> at a different position than&nbsp;<span data-keyref="Position_Origin">(0, 0, 0)</span>) is to set a falloff model using <span class="inline"><a href="../audio_falloff_set_model.htm">audio_falloff_set_model()</a></span>. The falloff model determines how the volume of the sound being played changes with the distance from the listener to the emitter.</p><p>It is not strictly required that you set this but if you don't call this function the model used will be the default&nbsp;<span class="inline">audio_fa<span class="inline"></span>lloff_none</span>. This means that the gain is set to 1 and so the volume of a sound does not change with the distance from the listener to the emitter.</p><p class="note"><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">NOTE</span></span>&nbsp;If you want to make sure sounds can no longer be heard past the maximum distance you should set one of the falloff models that end in <span class="inline">_scaled</span>.</p><h3>Updating the listener</h3><p>The default audio listener is located at position <span data-keyref="Position_Origin">(0, 0, 0)</span>. <a href="../audio_play_sound.htm">audio_play_sound</a>&nbsp;plays a sound at the listener's position. So by default sounds that are played this way will be audible through both speakers, right and left.</p><p>From the moment the relative position of the listener to the sound or emitter changes (by either changing the listener or the emitter position) this will no longer be the case.</p><p>It does not only have a <strong>position</strong>, it also has an <strong>orientation</strong>, which can be changed using <a href="../Audio_Listeners/audio_listener_orientation.htm">audio_listener_orientation</a>. By default, however, that orientation is upside down! The default orientation has the up vector set to <span data-keyref="Unit_Vector_Y">(0, 1, 0)</span>, but since <span data-keyref="GameMaker Name">GameMaker</span>'s&nbsp;y axis points downward, that means the listener is standing upside down in the room.</p><p>Everything that you expect to hear in the left speaker will actually be heard in the right speaker and vice versa (see the page on <a href="../Audio_Listeners/audio_listener_orientation.htm">audio_listener_orientation</a>&nbsp;for an image of how this looks). So once you start moving emitters and the listener around, make sure to set the listener's orientation to the following:&nbsp;</p><p class="code">audio_listener_orientation(0, 0, 1, 0, -1, 0);</p><p>The above line of code will set the default listener's orientation so that it looks <strong>into the screen</strong> and&nbsp;<strong>faces up</strong>. So this corresponds to a listener standing or sitting at the computer looking at the screen.</p><p>When you are creating a top-down game it can be more interesting to make the listener's orientation follow the direction that the player (or any other "listener") is facing. That can be done by the following line of code:&nbsp;</p><p class="code">audio_listener_orientation(0, 0, 1, lengthdir_x(1, direction), lengthdir_y(1, direction), 0);</p><p>In this line of code, instead of having an up vector that doesn't change at all (y = -1 all the time), you change it based on the direction of the player. The simplest way to do this is to use the&nbsp;<a href="../../../Maths_And_Numbers/Angles_And_Distance/lengthdir_x.htm">lengthdir_x</a>&nbsp;and&nbsp;<a href="../../../Maths_And_Numbers/Angles_And_Distance/lengthdir_y.htm">lengthdir_y</a>&nbsp;functions. The look at vector can stay the same since the listener is still looking into the screen.</p><h3>Playing sounds</h3><p>After setting a falloff model and making sure the listener's position and orientation are updated correctly, you can start playing sounds in the 3D audio space using&nbsp;<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>:&nbsp;</p><p class="code">sound_instance = audio_play_sound_at(snd_Explosion, x, y, 0, 100, 300, 1, true, 1);</p><p>The above line of code plays the sound "snd_Explosion" <strong>at</strong> the position (x, y, 0) with a falloff reference distance of 100, a falloff max distance of 300 and a falloff factor of 1.</p><p>Note that you can change certain properties of the sound since it can be accessed through the <span class="inline2">sound_instance</span> variable above. These are only properties of the sound itself, however, such as gain, offset and pitch. There is no way to change the position or velocity of sounds that are played using&nbsp;<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>.</p><p>All in all,&nbsp;<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>&nbsp;is a good way to play simple sounds in 3D audio space but it is limited. It doesn't allow you to change the position, the velocity or the falloff parameters once the sound is playing. Position and falloff parameters <i>are</i> passed to the function but cannot be changed afterwards.</p><p>If you want more control over how sounds are played, use an audio emitter.</p><h3>Adding an emitter</h3><p>Audio emitters are added using&nbsp;<a href="audio_emitter_create.htm">audio_emitter_create</a>. They are placed at&nbsp;<span data-keyref="Position_Origin">(0, 0, 0)</span>, have a velocity of 0 and default falloff settings.</p><p class="code">emitter = audio_emitter_create();</p><h3>Updating an emitter</h3><p>An audio emitter "emits" a sound. It can be compared to a speaker in the real world.</p><p>Compared to&nbsp;<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>, an emitter can have its position, velocity, listener mask and falloff parameters changed after you start playing a sound on it using <a href="audio_play_sound_on.htm">audio_play_sound_on</a>.</p><p>The position of an emitter can be updated using&nbsp;<a href="audio_emitter_position.htm">audio_emitter_position</a>. This can be set to an instance's position:&nbsp;</p><p class="code">audio_emitter_position(emitter, x, y, 0);</p><p>The velocity of an emitter is updated using&nbsp;<a href="audio_emitter_velocity.htm">audio_emitter_velocity</a>. The easiest way to set the velocity is by setting it to the <a href="../../Instances/Instance_Variables/hspeed.htm">hspeed</a> and <a href="../../Instances/Instance_Variables/vspeed.htm">vspeed</a> of an instance, like this:&nbsp;</p><p class="code">audio_emitter_velocity(emitter, hspeed, vspeed, 0);</p><p class="note"><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">NOTE</span></span>&nbsp;The <i>velocity</i> of an audio emitter is expressed in <i>pixels per step</i>.</p><h3>Audio emitters created by&nbsp;<span data-keyref="GameMaker Name">GameMaker</span></h3><p>When working with <a href="../../Sequences/Sequences.htm">Sequences</a>,&nbsp;<span data-keyref="GameMaker Name">GameMaker</span>&nbsp;adds creates audio emitter for every audio track (<span class="inline2">seqtracktype_audio</span>) in the sequence.&nbsp;The ID of these emitters can be found in the&nbsp;<a href="../../Sequences/Sequence_Structs/The_Sequence_Instance_Struct.htm">Sequence Instance's</a>&nbsp;<span class="inline2">activeTracks[i].emitterIndex</span>&nbsp;property.</p><p><span data-keyref="GameMaker Name">GameMaker</span>&nbsp;automatically updates the position of such an emitter. It does not update the velocity of an audio track emitter but this is something you can do yourself by calling&nbsp;<a href="audio_emitter_velocity.htm">audio_emitter_velocity</a>&nbsp;in one of the <a href="../../Sequences/Sequence_Events_Moments_Broadcast.htm">Sequence Step Events</a>.</p><h3>Playing sounds on an emitter</h3><p>Sounds can be played <strong>on</strong> an emitter using&nbsp;<a href="audio_play_sound_on.htm">audio_play_sound_on</a>:&nbsp;</p><p class="code">sound_instance = audio_play_sound_on(emitter,&nbsp;snd_Explosion, false, 10);<br></p><h3>Keeping track of playing sound instances</h3><p>Every time you call one of <a href="../audio_play_sound.htm">audio_play_sound</a>,&nbsp;<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>&nbsp;or&nbsp;<a href="audio_play_sound_on.htm">audio_play_sound_on</a>&nbsp;you create a new sound <strong>instance</strong>.</p><p>The sound instance being played may not be audible for various reasons, such as its position being too far away from the listener. But it always exists.</p><p>If you want to change the properties of the sound instance you should assign the return value to a variable, like this:&nbsp;</p><p class="code">sound_instance = audio_play_sound_at(snd_Explosion, x, y, 0, 100, 300, 1, true, 1);</p><p>At one point you may have quite a few sound instances playing. In that case you could store them in an array as follows:&nbsp;</p><p class="code">var _x =&nbsp;random(room_width);<br>var _y = random(room_height);<br>var _new_sound_instance = audio_play_sound_at(snd_Bird, _x, _y, 0, 200, 400, true, 10);<br>array_push(bird_sounds, _new_sound_instance);</p><p>Every time the above piece of code is executed the newly created sound instance's ID is added to the <span class="inline2">bird_sounds</span> array.</p><p>This way you can keep track of all sound instances (of <span class="inline">snd_Bird</span> in the above example) that are playing.</p><p class="note"><span data-conref="../../../../../assets/snippets/Tag_important.hts"><span class="important">IMPORTANT</span></span>&nbsp;That a sound is being "played" does not necessarily mean that it will be heard by the listener. Sounds that have stopped playing, that are too far away from the listener or that have a gain set that is too low (or that are played on an emitter that has a gain set that is too low) will not be audible.</p><h3>Additional listeners</h3><p>If you want to use additional listeners you should first check if the system supports multiple listeners using&nbsp;<a href="../Audio_Listeners/audio_get_listener_count.htm">audio_get_listener_count</a>.</p><p>If there is more than one listener,&nbsp;<a href="../Audio_Listeners/audio_get_listener_info.htm">audio_get_listener_info</a>&nbsp;can be used to get the name, listener mask and index of every listener.</p><p>If you know the listener index you can change its settings (position, velocity and orientation) using the functions starting with <span class="inline">audio_listener_set_</span> instead of <span class="inline">audio_listener_</span>.</p><h2>Functions</h2><p>The following functions exist to deal with audio emitters:</p><ul class="colour"><li><a href="audio_emitter_create.htm">audio_emitter_create</a></li><li><a href="audio_emitter_exists.htm">audio_emitter_exists</a></li><li><a href="audio_emitter_position.htm">audio_emitter_position</a></li><li><a href="audio_emitter_velocity.htm">audio_emitter_velocity</a></li><li><a href="audio_emitter_falloff.htm">audio_emitter_falloff</a></li><li><a href="audio_emitter_gain.htm">audio_emitter_gain</a></li><li><a href="audio_emitter_pitch.htm">audio_emitter_pitch</a></li><li><a href="audio_emitter_set_listener_mask.htm">audio_emitter_set_listener_mask</a></li><li><a href="audio_emitter_free.htm">audio_emitter_free</a></li><li><a href="audio_play_sound_on.htm">audio_play_sound_on</a></li><li><a href="audio_emitter_get_gain.htm">audio_emitter_get_gain</a></li><li><a href="audio_emitter_get_pitch.htm">audio_emitter_get_pitch</a></li><li><a href="audio_emitter_get_x.htm">audio_emitter_get_x</a></li><li><a href="audio_emitter_get_y.htm">audio_emitter_get_y</a></li><li><a href="audio_emitter_get_z.htm">audio_emitter_get_z</a></li><li><a href="audio_emitter_get_vx.htm">audio_emitter_get_vx</a></li><li><a href="audio_emitter_get_vy.htm">audio_emitter_get_vy</a></li><li><a href="audio_emitter_get_vz.htm">audio_emitter_get_vz</a></li><li><a href="audio_emitter_get_listener_mask.htm">audio_emitter_get_listener_mask</a></li><li><a href="audio_emitter_bus.htm">audio_emitter_bus</a></li><li><a href="audio_emitter_get_bus.htm">audio_emitter_get_bus</a></li></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div style="float:left">Back:&nbsp;<a href="../Audio.htm">Audio</a></div><div style="float:right">Next:&nbsp;<a href="../Audio_Listeners/Audio_Listeners.htm">Audio Listeners</a></div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div></body></html>
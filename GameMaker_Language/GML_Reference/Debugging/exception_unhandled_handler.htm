<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" src="../../../assets/import/jquery-3.6.1.min.js"></script><script type="text/javascript" src="../../../assets/import/layer/layer.js"></script><script type="text/javascript" src="../../../assets/import/pangu.min.js"></script><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/layui_btn.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/layui_col.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/layer/theme/default/layer.css"><link rel="stylesheet" type="text/css" href="../../../assets/import/main.css"><script>let str;removeHtml=function(t){return t=(t=(t=(t=t.replace(/(<([^>]+)>)/gi,"{}")).replace(/\r\n/g,"\n")).replace(/\n/g,"")).replace(/ {2,}/g," ")},retHtml=function(t){return t.match(/(<([^>]+)>)/gi)},setTranslator=function(t,n,a){let e;e=a?t.attr(a):t.html();let l=n[removeHtml(e)];if(null!=l&&l.length){n=retHtml(e);let o=0;n&&n.forEach(function(t,n){var a=l.replace("{"+o+"}",t);l=a===l?l.replace("{}",t):a,o++}),a?t.attr(a,l):t.html(l)}},noTranslationState=function(){return"true"==window.localStorage.getItem("noTranslationState")},noTranslationStateToggle=function(){window.localStorage.setItem("noTranslationState",!noTranslationState())},addNoTranslationStateButton=function(){$(".header").length&&$(".header").append(`
		
		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		window.location.replace('gmmt://'+document.location.hash)
		"
		>打开编辑器</button>

		<button style="
			float: right;
			font-size: 16px;
			padding: 4px 12px;
		"
		onclick="
		noTranslationStateToggle();
		location.reload();
    	event.stopPropagation();
		"
		>切换翻译</button>
		`)},removeExtensionFromHash=function(t){return t.replaceAll("#t=","").replaceAll("%2F","/").replaceAll(".htm","")},$(function(){if(addNoTranslationStateButton(),noTranslationState())return!1;$("div.footer a,h4,caption,blockquote").each(function(){setTranslator($(this),json_global)}),$("p,h1,h2,h3,td,li,a,div.dropspotnote,figcaption,.expandtext").each(function(){setTranslator($(this),json)}),$("th,.warning,.important,.optional").each(function(){setTranslator($(this),json_global)}),$(".header").length&&(window.setInterval(function(){$("#toc-panel a:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)}),$(".GlossDefinitionText:not('isTranslate')").each(function(){$(this).addClass("isTranslate"),setTranslator($(this),json_global)})},250),console.log("成功啦!现在正在疯狂翻译菜单中!")),$(".tooltip").each(function(){setTranslator($(this),json_global,"title")})}),document.addEventListener("DOMContentLoaded",()=>{pangu.autoSpacingPage()})</script><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../../..",gTopicId="8.2.2.22.0_4"</script><script type="text/javascript" src="../../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>exception_unhandled_handler</title><meta name="generator" content="Adobe RoboHelp 2022"><link rel="stylesheet" href="../../../assets/css/default.css" type="text/css"><script src="../../../assets/scripts/main_script.js" type="module"></script><meta name="rh-authors" content="Mark Alexander"><meta name="topic-comment" content="Reference page for exception_unhandled_handler"><meta name="rh-index-keywords" content="exception_unhandled_handler"><meta name="search-keywords" content="exception_unhandled_handler"><meta name="brsnext" value="GameMaker_Language/GML_Reference/Debugging/get_integer.htm"><meta name="brsprev" value="GameMaker_Language/GML_Reference/Debugging/debug_get_callstack.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="exception_unhandled_handler"><span>exception_unhandled_handler</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><h1>exception_unhandled_handler</h1><p>This runtime function can be used to "take over" the default <span data-keyref="GameMaker Name">GameMaker</span> error message when a runtime exception occurs. You supply a method or function which is called when the exception occurs, and its first argument will be a struct (known as the <strong><span data-keyref="Type_Struct_Exception"><a target="_blank" href="exception_unhandled_handler.htm">Exception Struct</a></span></strong>) containing information about the exception.&nbsp;This struct has the following format:</p><table><colgroup><col><col><col></colgroup><tbody><tr><th colspan="3"><span data-keyref="Type_Struct_Exception"><a target="_blank" href="exception_unhandled_handler.htm">Exception Struct</a></span></th></tr><tr><th>Variable</th><th>Type</th><th>Description</th></tr><tr><td><span class="inline">message</span></td><td><span data-keyref="Type_String"><a target="_blank" href="../../GML_Overview/Data_Types.htm">String</a></span></td><td>A short message for the exception</td></tr><tr><td><span class="inline">longMessage</span></td><td><span data-keyref="Type_String"><a target="_blank" href="../../GML_Overview/Data_Types.htm">String</a></span></td><td>A longer message for the exception</td></tr><tr><td><span class="inline">script</span></td><td><span data-keyref="Type_String"><a target="_blank" href="../../GML_Overview/Data_Types.htm">String</a></span></td><td>A string that describes where the exception came from</td></tr><tr><td><span class="inline">line</span></td><td><span data-keyref="Type_Real"><a target="_blank" href="../../GML_Overview/Data_Types.htm">Real</a></span></td><td>The line number where the exception came from</td></tr><tr><td><span class="inline">stacktrace</span></td><td><span data-keyref="Type_Array"><a target="_blank" href="../../GML_Overview/Arrays.htm">Array</a></span>&nbsp;of&nbsp;<span data-keyref="Type_String"><a target="_blank" href="../../GML_Overview/Data_Types.htm">String</a></span>s</td><td>An array of strings that is the <a href="debug_get_callstack.htm">callstack</a> for the frame when the exception was generated</td></tr></tbody></table><p>You can also supply <span class="inline">undefined</span> as the argument, which will remove the custom exception handler (if set) and revert to&nbsp;<span data-keyref="GameMaker Name">GameMaker</span>'s default error message.</p><p>This&nbsp;function will return the previously set exception handler method, however if it was never changed or&nbsp;it was previously&nbsp;reset using <span class="inline">undefined</span>, then it will simply return <span class="inline">undefined</span>.</p><p>Passing a method to this function&nbsp;means that no error message will be shown to the user, and you will be allowed to handle the exception yourself. However you cannot use this to "break out" of the exception to continue your game, as the game will still close after the exception handler is called. You also cannot call functions that keep the game running for longer than the final frame (e.g.&nbsp;<span class="inline"><a href="../General_Game_Control/game_restart.htm">game_restart()</a></span>) as the game needs to close after the crash.</p><p>Note that the context for running the method is <i>not</i> in an event, so nothing can be rendered to the screen at this time. In general, the safest thing that could be done at this point is to save a file with the exception context information so it could be - for example - parsed and processed on the next run of the game and then dealt with.</p><p>Note that if you use the <span class="inline">return</span> statement in the supplied method, then the given value will be converted to an integer and used as the exit code from the runner.</p><p>&nbsp;</p><h4>Syntax:</h4><p class="code">exception_unhandled_handler(user_handler);</p><table><tbody><tr><th>Argument</th><th>Type</th><th>Description</th></tr><tr><td>user_handler</td><td><span data-keyref="Type_Method"><a target="_blank" href="../../GML_Overview/Method_Variables.htm">Method</a></span></td><td>The method (user-defined function) to use as the exception handler, or <span class="inline">undefined</span> to reset it to default.</td></tr></tbody></table><p>&nbsp;</p><h4>Returns:</h4><p class="code"><span data-keyref="Type_Method"><a target="_blank" href="../../GML_Overview/Method_Variables.htm">Method</a></span>&nbsp;(or <span data-keyref="Type_Undefined"><a target="_blank" href="../../GML_Overview/Data_Types.htm">undefined</a></span>)</p><p>&nbsp;</p><h4>Example:</h4><p class="code">exception_unhandled_handler(function(ex)<br>{<br>&nbsp; &nbsp; // Print some messages to the output log<br>&nbsp;&nbsp;&nbsp;&nbsp;show_debug_message( "--------------------------------------------------------------");<br>&nbsp;&nbsp;&nbsp;&nbsp;show_debug_message( "Unhandled exception " + string(ex) );<br>&nbsp;&nbsp;&nbsp;&nbsp;show_debug_message( "--------------------------------------------------------------");<br><br>&nbsp; &nbsp; // Write the exception struct to a file<br>&nbsp;&nbsp;&nbsp;&nbsp;if file_exists("crash.txt") file_delete("crash.txt");<br>&nbsp;&nbsp;&nbsp;&nbsp;var _f = file_text_open_write("crash.txt");<br>&nbsp;&nbsp;&nbsp;&nbsp;file_text_write_string(_f, string(ex));<br>&nbsp;&nbsp;&nbsp;&nbsp;file_text_close(_f);<br><br>&nbsp; &nbsp; // Show the error message (for debug purposes only)<br>&nbsp; &nbsp; show_message(ex.longMessage);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;return 0;<br>});</p><p>The above code will create an exception handler method and use it to save a file with the exception data; it will also show the long error message in a new pop-up window for debug purposes.</p><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div style="float:left">Back: <a href="Debugging.htm">Debugging</a></div><div style="float:right">Next:&nbsp;<a href="get_integer.htm">get_integer</a></div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div></body></html>
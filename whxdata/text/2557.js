rh._.exports({"0":[[" ","YUV Videos"]],"1":[["yuv videos"]],"2":[[" ","YUV Videos"]],"3":[[" ","Platforms that use the YUV colour format for videos require extra steps for drawing those videos. This involves using a shader to draw two surfaces on a primitive quad."," ","Read the ","video_draw()"," reference page first for information on what data that function returns for YUV videos, and then continue reading below for instructions on using that data to draw the video."],[" ","Create a shader asset in your project, and replace its Fragment Shader (",".fsh",") code with this:"," ","//\n// CUSTOM fragment shader for handling YUV content\n//\nvarying vec2 v_vTexcoord;\nvarying vec4 v_vColour;\nuniform sampler2D v_chroma;\nconst float x = 1.164383;\nconst float y = 1.138393;\nconst float z = 1.138393;\nconst vec3 src_bias = vec3(16.0 / 255.0, 128.0 / 255.0, 128.0 / 255.0);\nconst mat3 src_xform = mat3(1.00000000 * x,  0.00000000 * y,  1.57480000 * z,\n                            1.00000000 * x, -0.18732427 * y, -0.46812427 * z,\n\t\t\t    1.00000000 * x,  1.85560000 * y,  0.00000000 * z);\nvoid main()\n{\n    float yy = texture2D(gm_BaseTexture, vec2(v_vTexcoord.x, v_vTexcoord.y)).r;\n    vec2 cbcr = texture2D(v_chroma, vec2(v_vTexcoord.x, v_vTexcoord.y)).rg;\n    vec3 yuv = vec3(yy, cbcr);\n    yuv -= src_bias;\n    yuv *= src_xform;\n    gl_FragColor = vec4(yuv, 1.0);\n}\n  \n"],[" ","In the Create event of your object, get the sampler ID of the ","v_chroma"," shader uniform, only if the video is YUV:"," ","var _format = video_get_format();\nif (_format == video_format_yuv)\n{\n    videochromasampler = shader_get_sampler_index(shader_YUV, \"v_chroma\");\n}\n"],[" ","In the Draw event of your object, call ","video_draw()",", and if its first array position is ","0"," (meaning the video is playing), draw the video."," ","In the code below, we're using a switch statement on the ","video_get_format()"," function. If the video is using the RGBA format, then it simply draws the surface in position ","[1]"," of the array."," ","If the video is using the YUV format, it uses the shader to draw the two surfaces (in positions ","[1]"," and ","[2]",") onto a primitive quad."," ","var _data = video_draw();\nif(_data[0] == 0)\n{\n\tswitch(video_get_format())\n\t{\n\t\tcase video_format_rgba:\n\t\t\tvar _surf = _data[1];\n\t\t\tdraw_surface(_surf,0,0);\n\t\tbreak;\n\t\n\t\t//  #### YUV PART HERE ####\n\t\tcase video_format_yuv:\n\t\t\tvar _surf = _data[1];\n\t\t\tvar _chromasurf = _data[2];\n\t\t\tif(surface_exists(_surf) and surface_exists(_chromasurf))\n\t\t\t{\n\t\t\t\tshader_set(shader_YUV);\n\t\t\t\n\t\t\t\tvar _tex_id = surface_get_texture(_surf);\n\t\t\t\tvar _chroma_tex_id = surface_get_texture(_chromasurf);\n\t\t\t\ttexture_set_stage(videochromasampler, _chroma_tex_id);\n\t\t\t\tgpu_set_texfilter(false);\n\t\t\t\n\t\t\t\tdraw_primitive_begin_texture(pr_trianglestrip, _tex_id);\n\t\t\t        draw_vertex_texture(0, 0, 0, 0);\n\t\t\t\tdraw_vertex_texture(surface_get_width(_chromasurf), 0, 1, 0);\n\t\t\t\tdraw_vertex_texture(0, surface_get_height(_chromasurf), 0, 1);\n\t\t\t\tdraw_vertex_texture(surface_get_width(_chromasurf), surface_get_height(_chromasurf), 1, 1);\n\t\t\t\tdraw_primitive_end();\n\t\t\t\n\t\t\t\tgpu_set_texfilter(true);\n\t\t\t\tshader_reset();\n\t\t\t}\n\t\tbreak;\n\t}\n}\n  "," ","The code under ","case video_format_yuv:"," does the following:"," ","Gets the video surface (","_surf",") and the chroma surface (","_chromasurf",")"," ","Makes sure that they exist, using ","surface_exist()"," ","Sets the shader to ","shader_YUV"," (which is our newly created YUV shader)"," ","Gets the textures of both surfaces"," ","Assigns the texture of the chroma surface to the sampler we retrieved in the Create event"," ","Disables texture filtering"," ","Begins drawing a triangle strip primitive, with the video surface's texture assigned to it"," ","Draws a rectangle to cover the video surface, uses the width and height of the chroma surface for that rectangle"," ","Ends the primitive"," ","Re-enables texture filtering and resets the shader"," ","Here the main video surface is being drawn by the primitive, and the chroma surface is being blended on to it by the shader. That is the reason why the texture of the chroma surface was passed into the shader via a sampler."," ","Back: ","Video Playback"," ","Next: ","video_set_volume"]],"4":[[" ","© Copyright YoYo Games Ltd. 2023 All Rights Reserved"]],"5":[["yuv videos"]],"7":[[" ","YUV Shader"],[" ","Get Sampler"],[" ","Draw Video"]],"id":"2557"})